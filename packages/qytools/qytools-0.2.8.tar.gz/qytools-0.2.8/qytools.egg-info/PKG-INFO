Metadata-Version: 2.1
Name: qytools
Version: 0.2.8
Summary: SQLite3 database reading interface,general SQLite3 database warehousing interface,general SQLite3 database query assistant tool
Home-page: https://gitee.com/yulin_qiu/projects
Author: Yulin Qiu
Author-email: x492876854@qq.com
License: UNKNOWN
Description: ğŸ“¦ qytools
        =======================
        
        ## æ–‡ä»¶å†…å®¹
         `db_read.py`æ•°æ®åº“å–å‡ºæ•°æ®  
         `db_maintain.py`æ•°æ®åº“å½•å…¥æ•°æ®  
         `tools.py`æ•°æ®åº“/å› å­æ„é€ ç›¸å…³å®ç”¨å·¥å…·åŒ…  
         `stack.py`å †æ ˆ  
        
        ## å‰è¨€
        * æ“ä½œä¸­è´¢é‡åŒ–ç ”ç©¶é™¢æ‰€æ‹¥æœ‰çš„å…¨éƒ¨sqlite3æ•°æ®åº“ï¼Œå…·ä½“æ“ä½œè§ä¸‹é¢ç›¸å…³æ–‡ä»¶æè¿°
        * æ¯”å¸¸è§„selectè¯­å¥é€Ÿåº¦é«˜å‡ºæ•°å€~æ•°åå€ï¼Œæ•°æ®é‡è¶Šå¤§æå‡é€Ÿåº¦è¶Šæ˜æ˜¾
        * ä»…ä¾›ä¸­è´¢é‡åŒ–ç ”ç©¶é™¢æˆå‘˜å­¦ä¹ ä½¿ç”¨
        * dbreadé‡‡å–å†…ç½®æ–‡æ¡£çš„å½¢å¼ï¼Œå¯¹æ¥å£ä½¿ç”¨æœ‰ç–‘é—®å¯ä»¥ç›´æ¥å‚è€ƒREADME+å†…ç½®æ–‡æ¡£
        
        ## ä½œè€…
        
        **qytools** Â© [yulin qiu](https://gitee.com/yulin_qiu/projects), Released under the [MIT](./LICENSE) License.<br>
        > qq: 492876854  
        > Weixin: QQ492876854  
        > e-mail: x492876854@qq.com
        
        
        ## ç¯å¢ƒå‡†å¤‡
        pipreqs==0.4.10  
        pandas>=1.0.1  
        numpy>=1.16.2  
        tushare>=1.2.52  
        
        
        ## ä½¿ç”¨å‡†å¤‡
        * dbreadæ¥å£åŠŸèƒ½éœ€è¦ä½¿ç”¨tushareï¼Œéœ€è¦ç¡®ä¿æœ¬æœºæ‹¥æœ‰tushareåŒ…å¹¶ä¸”å·²ç»æ‰§è¡Œè¿‡[set_token](https://tushare.pro/document/1?doc_id=37)
        * å°½é‡ç¡®ä¿tushareæ‹¥æœ‰[200ä»¥ä¸Šç§¯åˆ†ï¼Œæˆ–è€…å…¥tushareå®˜æ–¹ç¾¤è”ç³»ç®¡ç†å‘˜](https://tushare.pro/document/1?doc_id=13) å­¦ç”Ÿå¯ä»¥æ‹¥æœ‰å…è´¹ä½¿ç”¨æƒé™
        * é¦–æ¬¡ä½¿ç”¨tushareéœ€è¦æ ¹æ®å®˜ç½‘æŒ‡ç¤ºè®¾ç½®token[200ä»¥ä¸Šç§¯åˆ†ï¼Œæˆ–è€…å…¥tushareå®˜æ–¹ç¾¤è”ç³»ç®¡ç†å‘˜](https://tushare.pro/document/1?doc_id=40) å¦åˆ™qytoolséƒ¨åˆ†åŠŸèƒ½æ— æ³•ä½¿ç”¨ï¼Œä¹‹åå…¨å±€æœ‰æ•ˆï¼Œæ— éœ€è®¾ç½®
        
        ## æ–‡ä»¶æ–‡æ¡£
         ### `db_read.py`  
        åŸºäºè‚¡ç¥¨sqliteæ•°æ®åº“çš„é€šç”¨å‹æ¥å£`class: DbReader`ï¼Œ  
        **ä½¿ç”¨æµç¨‹**  
        
        1. `from qyltools import Dbreader`
        
        2. é¦–æ¬¡ä½¿ç”¨æ—¶é¢„å…ˆæ‰§è¡Œä¸€æ¬¡ï¼Œæ‰§è¡ŒæˆåŠŸåç•¥è¿‡ï¼Œè¿›è¡Œæ­¥éª¤3ï¼ˆç±»ä¼¼tushare set_tokenï¼‰ï¼š  
           `Dbreader.firsttime_setconfig(sqlite3æ•°æ®æ–‡ä»¶å­˜æ”¾ç›®å½•)`  
            ä¾‹å¦‚ï¼š
            `Dbreader.firsttime_setconfig(r'D:\learn\navicat\data'ï¼‰`
        3. `read = Dbreader`  
            `read.read_ts_day_data(å‚æ•°)`
        
        ä¸»è¦æ‹¥æœ‰ä»¥ä¸‹åŠŸèƒ½
        1. è¯»å–æ•°æ®ç±»  
            * `read_tdx_1min_data` è·å–åˆ†é’Ÿæ•°æ®
            * `read_ts_top_inst` è·å–é¾™è™æ¦œæœºæ„æ˜ç»†
            * `read_ts_top_list` è·å–é¾™è™æ¦œè‚¡ç¥¨æ˜ç»†
            * `read_ts_day_data` è·å–æ—¥çº¿ç»¼åˆæ•°æ®
            * `read_ts_index_daily` è·å–æŒ‡æ•°æ—¥çº¿æ•°æ®
            * `read_ts_limit_list` è·å–æ¯æ—¥æ¶¨åœæ¿æ•°æ®
            * `read_ts_moneyflow_hsgt` è·å–æ²ªæ·±æ¸¯é€šèµ„é‡‘æµæ•°æ®
            * `read_concept_data` è·å–æ¿å—ä¿¡æ¯
            * `read_jj_1min_index_data` è·å–æŒ‡æ•°åˆ†é’Ÿæ•°æ®ï¼ˆæ˜é‡‘æ•°æ®æºï¼‰
            * `read_fundamentals` è·å–è‚¡ç¥¨å…¬å¸è´¢åŠ¡æ•°æ®
            * `read_strategy` è·å–AIç­–ç•¥å› å­è¡¨
            * `read_cal_market_1min_data` è·å–è®¡ç®—å› å­è¡¨
            * `query_stock_day` é€šç”¨å‹è‚¡ç¥¨æ—¥çº¿æ•°æ®è¡¨æ¥å£
            * `query_stock_min` é€šç”¨å‹è‚¡ç¥¨åˆ†é’Ÿæ•°æ®è¡¨æ¥å£
            * `query_index_day` é€šç”¨å‹æŒ‡æ•°æ—¥çº¿æ•°æ®è¡¨æ¥å£
            * `query_index_min` é€šç”¨å‹æŒ‡æ•°åˆ†é’Ÿæ•°æ®è¡¨æ¥å£  
            * `query_market_min` é€šç”¨å‹å¸‚åœºåˆ†é’Ÿæ•°æ®è¡¨æ¥å£  
            * `query_market_day` é€šç”¨å‹å¸‚åœºæ—¥çº¿æ•°æ®è¡¨æ¥å£  
            * `query_stock_limitday` è·å–è‚¡ç¥¨æŒ‡å®šæ—¶é—´é•¿åº¦çš„æ—¥çº¿æ•°æ®æ¥å£ï¼ˆå¤„ç†åœç‰Œè‚¡ä¸“ç”¨ï¼‰  
               
                * ä¸»è¦å‚æ•°è¯´æ˜   
                `start` â€“ å¼€å§‹æ—¥æœŸï¼Œå¿…é€‰ï¼Œæ”¯æŒint(20180808), datetime('2018-08-08 00:00:00'), str('20180808')  
                `end` â€“ ç»“æŸæ—¥æœŸ ï¼Œå¿…é€‰ï¼Œæ”¯æŒåŒstart  
                `fields` â€“ è¦ä»åº“ä¸­å–å‡ºçš„åˆ—å,é»˜è®¤å–æ‰€æœ‰ï¼Œæ”¯æŒstrå’Œlist[str]ï¼Œä¾‹å¦‚'code,high', ['code','high']  
                `code` â€“ ä»£ç ï¼Œé»˜è®¤å–æ‰€æœ‰ï¼Œæ”¯æŒintå¦‚300, listå¦‚[1, '300', 399905]åˆ—è¡¨å†…å¯ä»¥æ˜¯æ•°å€¼æˆ–str  
                `shift` â€“ å¾€å‰æ¨çš„æ—¶é—´ï¼Œé»˜è®¤0ï¼Œä»…æ”¯æŒint  
                `forward` â€“ å¾€åæ¨çš„æ—¶é—´ï¼Œé»˜è®¤0ï¼Œä»…æ”¯æŒint  
                `newdrop` â€“ æ–°è‚¡ä¸Šå¸‚å¤šå°‘äº¤æ˜“æ—¥å†…ä¸äº¤æ˜“ï¼Œé»˜è®¤0ï¼Œä»…æ”¯æŒint  
                `stdrop` â€“ æ˜¯å¦å‰”é™¤stè‚¡ï¼ŒTrueå‰”é™¤ï¼Œé»˜è®¤True  
                `deldrop` â€“ æ˜¯å¦å‰”é™¤é€€å¸‚è‚¡ï¼ŒTrueå‰”é™¤ï¼Œé»˜è®¤False  
                `stardrop` â€“ æ˜¯å¦å‰”é™¤ç§‘åˆ›æ¿è‚¡ï¼ŒTrueå‰”é™¤ï¼Œé»˜è®¤True  
                `time_start` â€“ åˆ†é’Ÿæ•°æ®çš„å¯é€‰å‚æ•°ï¼Œå¼€å§‹æ—¶é—´ï¼Œé»˜è®¤Noneï¼Œæ”¯æŒstrå¦‚'09:35:30'  
        		`time_end` â€“ åˆ†é’Ÿæ•°æ®çš„å¯é€‰å‚æ•°ï¼Œç»“æŸæ—¶é—´ï¼Œé»˜è®¤Noneï¼Œæ”¯æŒstrå¦‚'09:35:30'  
                `tablename` â€“ æŸ¥è¯¢è¡¨åï¼Œstrç±»å‹  
                `dbname` â€“ æ•°æ®åº“åï¼Œstrç±»å‹ï¼Œåç¼€å¯åŠ å¯ä¸åŠ ï¼Œå¦‚testæˆ–test.sqlite3å‡åˆæ³•  
                
                    è¿”å›å€¼ä¸º`dataframe`æ ¼å¼æ•°æ®è¡¨.
                * ç¤ºä¾‹1ï¼š
                > 
                    [In]: read.read_ts_day_data(start='20200313', end=20200313, forward=1, shift=1, newdrop=60)  # å‚æ•°è§æ–‡æ¡£ï¼ˆctrl+Qï¼‰
                    
                    [Out]:
                                id             code         date  ...   up_limit    vol     volume_ratio
                                10575  1753771  603998  2020-03-13  ...      7.67   59193.06          1.01
                                10576  1757673  603998  2020-03-16  ...      7.45   65566.00          1.11
                                10577  1751490  603999  2020-03-12  ...      7.12   94223.01          1.06
                                10578  1755746  603999  2020-03-13  ...      6.89  112777.40          1.29
                                10579  1756595  603999  2020-03-16  ...      6.64   83763.32          0.89
                                [5 rows x 42 columns]
                 
                 * ç¤ºä¾‹2ï¼š
                > 
                    [In]: query_index_min(start=20200402, end=20200402, tablename='jj_1min_index_data', dbname='jj_data')
                    
                    [Out]: 
                            code        date  ...      volume             datetime
                    1915  399006  2020-04-02  ...  17922320.0  2020-04-02 14:56:00
                    1916  399006  2020-04-02  ...  16854299.0  2020-04-02 14:57:00
                    1917  399006  2020-04-02  ...   1227189.0  2020-04-02 14:58:00
                    1918  399006  2020-04-02  ...         0.0  2020-04-02 14:59:00
                    1919  399006  2020-04-02  ...  33783690.0  2020-04-02 15:00:00
                    [5 rows x 10 columns]
        
        
        2. å·¥å…·ç®±
            * `get_tableinfo_cols` è·å–æŸä¸ªæ•°æ®åº“æŸä¸ªè¡¨çš„æ‰€æœ‰åˆ—å
            * `check_time` ä¿®æ­£æ—¶é—´æ ¼å¼ï¼Œè¾“å…¥`str` `int` `datetime`ç»Ÿä¸€å˜ä¸º`str: '2018-09-08'`å‹
            * `get_timesection` è·å–æŒ‡å®šèµ·æ­¢æ—¥æœŸçš„äº¤æ˜“æ—¥å†  
                * ç¤ºä¾‹1ï¼š
                >
                    [In]: read.get_timesection(start='20200313', end=20200315, shift=5)  # shiftä¸ºå‚æ•°ï¼Œå–å‰näº¤æ˜“æ—¥  
                   
                    [Out]:  
                    ['2020-03-06', '2020-03-09', '2020-03-10', '2020-03-11', '2020-03-12', '2020-03-13']
            * `get_opendate` æŸ¥æ‰¾æŒ‡å®šæ—¶é—´é™„è¿‘çš„äº¤æ˜“æ—¥  
            
                * ç¤ºä¾‹2ï¼š
                >
                    [In]: read.get_opendate(time=20200315, shift=1)  # shiftä¸ºå‚æ•°ï¼Œå–å‰näº¤æ˜“æ—¥`
                    
                    [Out]:
                    `2020-03-13
          
            
            
        ### `db_maintain.py`
        > #### æ³¨æ„äº‹é¡¹
         >* ä½¿ç”¨`db_maintain.py`åªéœ€è¦äº†è§£æœ€åŸºç¡€çš„`sql`è¯­æ³•å«ä¹‰å³å¯ä½¿ç”¨ï¼Œå¦‚æœ‰ç–‘é—®ï¼Œå‚è€ƒ[sqlè¯­æ³•æ–‡æ¡£](https://www.runoob.com/sql/sql-syntax.html)
         >* æ¥å£`db_maintain.py`æ–‡ä»¶é‡Œå‡æœ‰ä¸»è¦åŠŸèƒ½çš„è¯¦ç»†å‚æ•°è¯´æ˜ï¼Œå¯ä»¥é€šè¿‡`main`é‡Œçš„ç¤ºä¾‹ï¼Œå¯¹ä¸Šè¿°4ä¸ªåŠŸèƒ½ctrl+é¼ æ ‡å·¦é”®æˆ–Ctrl+QæŸ¥çœ‹
         >* åŸºæœ¬åŠŸèƒ½åŒ…æ‹¬4ä¸ª:  
        >`update_data`  
        >`replace_data`  
        >`rebuild_data`  
        >`insert_data`    
        >ä¸‹é¢é€ä¸€ä»‹ç»
        >
        
        ***
        
        * #### `update_data`  
        æ­¤æ¥å£æŒç®¡æ•°æ®æ›´æ–°ï¼Œä¸`sql`ä¸­çš„`update`å«ä¹‰ç±»ä¼¼ï¼Œå°†åŸæ¥è¡¨çš„æŸäº›å·²æœ‰æ•°æ®æ›´æ–°ï¼Œæ¯”å¦‚å°†`test`è¡¨ä¸­2018å¹´10æœˆ15æ—¥åˆ°16æ—¥çš„`volume`æ”¹å˜ä¸ºè¾“å…¥`df`ä¸­çš„å¯¹åº”å€¼ï¼Œç›¸æ¯”`sql`è¯­å¥çš„`update`ï¼Œç›´æ¥é¢å¤–æ·»åŠ åˆ—ï¼Œä»¥åŠè‡ªåŠ¨è£å‰ªé‡å¤æ•°æ®  
        ç¤ºä¾‹ï¼š
        >
            factor.update_data(
                    dbpath='D/fundamentals.sqlite3', tablename='test',
                    newcols={'circ_mv': 'real'}, df_data=df, index_col='code,date', autoadd=True)  
        ä¸Šè¿°ä»£ç åŸºæœ¬å«ä¹‰ä¸ºï¼šåœ¨`D`ç›˜æ›´æ–°`fundamental`æ•°æ®åº“ä¸­çš„`test`è¡¨ï¼Œæ–°å¢ä¸€åˆ—`circ_mv`ä¸”å®šä¹‰æ ¼å¼ä¸º`real`ï¼Œ
        ä¼ å…¥çš„`dataframe`ä¸º`df`ï¼Œtestè¡¨çš„ç´¢å¼•ä¸º`code,date`ï¼Œ`autoadd`æ‰“å¼€åˆ™å‰©ä½™æœªåƒ`circ_mv`å®šä¹‰ä¸º`real`çš„é¢å¤–åˆ—
        ï¼ˆdfæœ‰è€Œæ•°æ®åº“æ²¡æœ‰çš„åˆ—ï¼‰å°†æŒ‰ç…§`sqlite`é»˜è®¤æ ¼å¼å…¥åº“
        >
            ä½¿ç”¨åœºæ™¯ï¼šæŸæ®µæ—¶é—´åŒºé—´çš„æŸå‡ åˆ—æ•°æ®æœ‰é—®é¢˜ï¼Œé‡æ–°å…¥åº“å¯¹åº”å‡ åˆ—æ—¶ä½¿ç”¨ 
        
        * #### `replace_data`  
        æ­¤æ¥å£æŒç®¡æ•°æ®è¡¨å®Œå…¨æ›¿æ¢ï¼Œè°¨æ…ä½¿ç”¨ï¼Œä½¿ç”¨ååŸè¡¨ä¼šåˆ é™¤ï¼Œæ“ä½œå’Œ`update`å¤§ä½“ä¸€è‡´ï¼Œé¢å¤–å¤šå‚æ•°`index_name`ï¼Œä¸ºæ›¿æ¢åæ–°è¡¨çš„åˆ›å»ºçš„ç´¢å¼•åç§°å¦‚`'index_b1' ` 
        
            ä½¿ç”¨åœºæ™¯ï¼šæ•´ä¸ªè¡¨è¿‡äºè€æ—§æˆ–å‡ºäºå…¶ä»–åŸå› è¦æ•´è¡¨æ›¿æ¢æ—¶ä½¿ç”¨
        
        
        * #### `rebuild_data`  
        æ­¤æ¥å£æŒç®¡å·²æœ‰æ•°æ®çš„æ›¿æ¢ï¼Œç›¸å¯¹äº`replace`æ›´ä¸ºæ¸©å’Œï¼Œç›¸å¯¹äº`update`æ›´ä¸ºæ¿€è¿›ï¼Œæ˜¯åœ¨åŸè¡¨åŸºç¡€ä¸Šä¿®æ”¹ä¸€éƒ¨åˆ†æ•°æ®ï¼Œä½†æ˜¯æ˜¯æŒ‰ç…§æ—¶é—´åŒºé—´ï¼Œèµ·å§‹æ—¶é—´åˆ°ç»ˆæ­¢æ—¶é—´çš„æ‰€æœ‰æ•°æ®ä¼šè¢«æ¸…ç©ºåé‡æ–°å†™å…¥ï¼Œä¸èƒ½æŒ‡å®šæŸä¸€åˆ—ï¼Œæ“ä½œæ–¹æ³•åŒ`update`  
        
            ä½¿ç”¨åœºæ™¯ï¼šæŸæ®µæ—¶é—´åŒºé—´çš„æ•°æ®æ•´ä½“æ€§å…¥é”™ï¼Œé‡æ–°å…¥åº“æ—¶ä½¿ç”¨
        
        * #### `insert_data`  
        æ­¤æ¥å£æŒç®¡æ•°æ®æ’å…¥ï¼Œä¸`sql`ä¸­çš„`insert`å«ä¹‰ç±»ä¼¼ï¼Œä½†æ˜¯ç›¸æ¯”`sql`è¯­å¥ï¼Œè¯¥æ¥å£å¯ä»¥é¢å¤–æ·»åŠ åˆ—ï¼Œä»¥åŠè‡ªåŠ¨è£å‰ªå’Œåº“é‡Œé‡å¤æ•°æ®ï¼Œæ“ä½œæ–¹å¼ä¸`update`åŸºæœ¬ä¸€è‡´,é¢å¤–å¤šäº†`insertmode`å‚æ•°ï¼Œè¯¦ç»†è§£é‡Šè§`db_maintain`  
        
            ä½¿ç”¨åœºæ™¯ï¼šæ·»åŠ æ–°æ•°æ®ï¼Œæ¯æ—¥æ›´æ–°æ•°æ®åº“ç­‰
        
        * #### `creat_dbtable`  
        æ­¤æ¥å£æŒç®¡å»ºåº“å»ºè¡¨æˆ–è€…åœ¨å·²å­˜åœ¨çš„åº“é‡Œå»ºè¡¨ï¼Œè¯¦ç»†è§£é‡Šè§`db_maintain`  
        
            ä½¿ç”¨åœºæ™¯ï¼šæ–°å»ºäº†æ•°æ®åº“æˆ–è€…å› å­è¡¨ï¼Œç”¨äºä»–äººä½¿ç”¨æ—¶æ— åº“å»ºåº“ï¼Œæ— è¡¨å»ºè¡¨ï¼Œä½¿å¾—ä½¿ç”¨è€…å®Œå…¨ä¸éœ€è¦æŒæ¡æ•°æ®åº“æ“ä½œå³å¯å®Œæˆç›¸å…³éœ€æ±‚
        
        License
        -------
        
        This is free and unencumbered software released into the public domain.
        
        Anyone is free to copy, modify, publish, use, compile, sell, or
        distribute this software, either in source code form or as a compiled
        binary, for any purpose, commercial or non-commercial, and by any means.
        
        
Platform: UNKNOWN
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Description-Content-Type: text/markdown
