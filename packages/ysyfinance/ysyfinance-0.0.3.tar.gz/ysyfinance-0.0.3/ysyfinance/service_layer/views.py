# AUTOGENERATED! DO NOT EDIT! File to edit: nbs/11_service_layer.views.ipynb (unless otherwise specified).

__all__ = ['__all__', 'get_budget', 'view_etl']

# Cell
#export
from . import unit_of_work
from ysyfinance import commons
from pyspark.sql import DataFrame

# Cell
__all__=['get_budget', 'view_etl']

# Cell
def get_budget(uow: unit_of_work.SparkUnitOfWork):
    with uow:
        results = uow.repo.get('budget_precalc')
    return results

# Cell
def view_etl(uow: unit_of_work.AbstractUnitOfWork, reference: str, pipeline_name: str) -> DataFrame:
    with uow:
        result = uow.repo.load(reference=reference, pipeline_name=pipeline_name)
#         return jsonify(commons.jsonify_deltalake(result))
        return result.dataframe