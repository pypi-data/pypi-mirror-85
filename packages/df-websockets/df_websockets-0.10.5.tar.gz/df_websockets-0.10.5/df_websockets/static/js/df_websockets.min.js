!function(e){var n={};function t(o){if(n[o])return n[o].exports;var l=n[o]={i:o,l:!1,exports:{}};return e[o].call(l.exports,l,l.exports,t),l.l=!0,l.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var l in e)t.d(o,l,function(n){return e[n]}.bind(null,l));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){t(1),t(2),e.exports=t(3)},function(e,n){window.DFSignals={connection:null,buffer:[],registry:{},wsurl:null},document.addEventListener("DOMContentLoaded",(function e(){if(null===window.DFSignals.wsurl){const e=function(e){const n=e+"=",t=decodeURIComponent(document.cookie).split(";");for(let e=0;e<t.length;e++){let o=t[e];for(;" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(n))return o.substring(n.length,o.length)}return""}("dfwsurl");window.DFSignals.wsurl=decodeURIComponent(e)}if(!window.DFSignals.wsurl)return;const n=new WebSocket(window.DFSignals.wsurl);n.onopen=()=>{window.DFSignals.connection=n;for(let e=0;e<window.DFSignals.buffer.length;e++)n.send(window.DFSignals.buffer[e]);window.DFSignals.buffer=[]},n.onmessage=e=>{console.debug("received call "+e.data+" from server.");const n=JSON.parse(e.data);n.signal&&n.signal_id&&window.DFSignals.call(n.signal,n.opts,n.signal_id)},n.onerror=e=>{console.error("WS error: "+e)},n.onclose=()=>{window.DFSignals.connection=null,setTimeout(e,3e3)}})),window.DFSignals.call=function(e,n,t){if(void 0!==t&&void 0!==window.DFSignals.registry[t])return!1;if(void 0!==t&&(window.DFSignals.registry[t]=!0),void 0!==window.DFSignals.registry[e]){console.debug('call "'+e+'"',n);for(let o=0;o<window.DFSignals.registry[e].length;o+=1)window.DFSignals.registry[e][o](n,t)}if(void 0===t){console.debug('call from client: "'+e+'"',n);const t=JSON.stringify({signal:e,opts:n});window.DFSignals.connection?window.DFSignals.connection.send(t):window.DFSignals.buffer.push(t)}return!1},window.DFSignals.connect=function(e,n){void 0===window.DFSignals.registry[e]&&(window.DFSignals.registry[e]=[]),window.DFSignals.registry[e].push(n)}},function(e,n){document.addEventListener("DOMContentLoaded",(function(){window.DFSignals.connect("html.add_class",e=>{document.querySelectorAll(e.selector).forEach(n=>{n.classList.add(e.class_name)})}),window.DFSignals.connect("html.after",e=>{document.querySelectorAll(e.selector).forEach(n=>{n.insertAdjacentElement("afterend",e.content)})}),window.DFSignals.connect("html.append",e=>{document.querySelectorAll(e.selector).forEach(n=>{n.append(e.content)})}),window.DFSignals.connect("html.before",e=>{document.querySelectorAll(e.selector).forEach(n=>{n.insertAdjacentElement("beforebegin",e.content)})}),window.DFSignals.connect("html.empty",e=>{document.querySelectorAll(e.selector).forEach(e=>{for(;e.firstChild;)e.removeChild(e.firstChild)})}),window.DFSignals.connect("html.prepend",e=>{document.querySelectorAll(e.selector).forEach(n=>{n.insertBefore(e.content,parent.firstChild)})}),window.DFSignals.connect("html.remove",e=>{document.querySelectorAll(e.selector).forEach(e=>{e.parentNode.removeChild(e)})}),window.DFSignals.connect("html.remove_attr",e=>{document.querySelectorAll(e.selector).forEach(n=>{n.removeAttribute(e.attr_name)})}),window.DFSignals.connect("html.remove_class",e=>{document.querySelectorAll(e.selector).forEach(n=>{n.classList.remove(e.class_name)})}),window.DFSignals.connect("html.replace_with",e=>{document.querySelectorAll(e.selector).forEach(n=>{n.outerHTML=e.content})}),window.DFSignals.connect("html.add_attribute",e=>{document.querySelectorAll(e.selector).forEach(n=>{n.setAttribute(e.attr_name,e.attr_value)})}),window.DFSignals.connect("html.content",e=>{document.querySelectorAll(e.selector).forEach(n=>{n.innerHTML=e.content})}),window.DFSignals.connect("html.text",e=>{document.querySelectorAll(e.selector).forEach(n=>{n.textContent=e.content})}),window.DFSignals.connect("html.download_file",e=>{const n=document.createElement("a");n.href=e.url,n.target="_blank",n.download=e.filename||"unknown";const t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});n.dispatchEvent(t),(window.URL||window.webkitURL).revokeObjectURL(n.href)}),window.DFSignals.connect("html.focus",e=>{const n=document.querySelector(e.selector);n&&n.focus()})}))},function(e,n,t){"use strict";function o(e){const n=[];for(let t=0;t<e.elements.length;t++){const o=e.elements[t];if(o.name&&!o.disabled&&"reset"!==o.type&&"submit"!==o.type&&"button"!==o.type)if("file"===o.type)for(let e=0;e<o.files.length;e++)n.push({name:o.name,value:o.files[e].name});else if("select-multiple"===o.type)for(let e=0;e<o.selectedOptions.length;e++)n.push({name:o.name,value:o.selectedOptions[e].value});else("checkbox"!==o.type&&"radio"!==o.type||o.checked)&&n.push({name:o.name,value:o.value})}return n}t.r(n),t.d(n,"serializeForm",(function(){return o})),document.addEventListener("DOMContentAdded",e=>{window.setTimeout(()=>{!function(e){e.target.querySelectorAll("[data-df-signal]").forEach(e=>{JSON.parse(e.getAttribute("data-df-signal")).forEach(n=>{let t=n.on;t||(t="FORM"===e.tagName?"submit":"INPUT"===e.tagName&&"reset"!==e.type&&"submit"!==e.type&&"button"!==e.type||"TEXTAREA"===e.tagName?"change":"click");e.addEventListener(t,l=>{const r=n.prevent,i=n.opts||{};if(n.form&&(i[n.form]=o(e)),n.value)if("file"===e.type){i[n.value]=[];for(let t=0;t<e.files.length;t++)i[n.value].push(e.files[t].name)}else if("select-multiple"===e.type){i[n.value]=[];for(let t=0;t<e.selectedOptions.length;t++)i[n.value].push(e.selectedOptions[t].value)}else"checkbox"===e.type||"radio"===e.type?i[n.value]=e.checked:i[n.value]=e.value;window.DFSignals.call(n.name,i),(!0===r||null===r&&"change"!==t)&&l.preventDefault()})})})}(e)},200)})}]);
//# sourceMappingURL=df_websockets.min.js.map