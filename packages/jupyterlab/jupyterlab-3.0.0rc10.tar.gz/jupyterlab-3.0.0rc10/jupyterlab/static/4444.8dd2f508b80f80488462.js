(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[4444,7048],{27048:(t,e,r)=>{"use strict";r.r(e);r.d(e,{IHTMLViewerTracker:()=>w,HTMLViewer:()=>T,HTMLViewerFactory:()=>j});var n=r(90265);var s=r.n(n);var o=r(66995);var i=r.n(o);var a=r(18834);var l=r.n(a);var c=r(21157);var h=r.n(c);var u=r(29103);var d=r.n(u);var m=r(52191);var p=r.n(m);var _=r(63117);var b=r.n(_);var g=r(77865);var v=r.n(g);const w=new m.Token("@jupyterlab/htmlviewer:IHTMLViewerTracker");const f=1e3;const y="jp-HTMLViewer";class T extends a.DocumentWidget{constructor(t){super(Object.assign(Object.assign({},t),{content:new n.IFrame({sandbox:["allow-same-origin"]})}));this._renderPending=false;this._parser=new DOMParser;this._monitor=null;this._objectUrl="";this._trustedChanged=new _.Signal(this);this.translator=t.translator||c.nullTranslator;const e=this.translator.load("jupyterlab");this.content.addClass(y);void this.context.ready.then((()=>{this.update();this._monitor=new o.ActivityMonitor({signal:this.context.model.contentChanged,timeout:f});this._monitor.activityStopped.connect(this.update,this)}));this.toolbar.addItem("refresh",new n.ToolbarButton({icon:u.refreshIcon,onClick:async()=>{if(!this.context.model.dirty){await this.context.revert();this.update()}},tooltip:e.__("Rerender HTML Document")}));this.toolbar.addItem("trust",n.ReactWidget.create(g.createElement(x.TrustButtonComponent,{htmlDocument:this,translator:this.translator})))}get trusted(){return this.content.sandbox.indexOf("allow-scripts")!==-1}set trusted(t){if(this.trusted===t){return}if(t){this.content.sandbox=x.trusted}else{this.content.sandbox=x.untrusted}this.content.url=this.content.url;this._trustedChanged.emit(t)}get trustedChanged(){return this._trustedChanged}dispose(){if(this._objectUrl){try{URL.revokeObjectURL(this._objectUrl)}catch(t){}}super.dispose()}onUpdateRequest(){if(this._renderPending){return}this._renderPending=true;void this._renderModel().then((()=>this._renderPending=false))}async _renderModel(){let t=this.context.model.toString();t=await this._setBase(t);const e=new Blob([t],{type:"text/html"});const r=this._objectUrl;this._objectUrl=URL.createObjectURL(e);this.content.url=this._objectUrl;if(r){try{URL.revokeObjectURL(r)}catch(n){}}return}async _setBase(t){const e=this._parser.parseFromString(t,"text/html");let r=e.querySelector("base");if(!r){r=e.createElement("base");e.head.insertBefore(r,e.head.firstChild)}const n=this.context.path;const s=await this.context.urlResolver.getDownloadUrl(n);r.href=s;r.target="_self";return e.documentElement.innerHTML}}class j extends a.ABCWidgetFactory{createNewWidget(t){return new T({context:t})}}var x;(function(t){t.untrusted=[];t.trusted=["allow-scripts"];function e(t){const e=t.translator||c.nullTranslator;const r=e.load("jupyterlab");return g.createElement(n.UseSignal,{signal:t.htmlDocument.trustedChanged,initialSender:t.htmlDocument},(e=>g.createElement(n.ToolbarButtonComponent,{className:"",onClick:()=>t.htmlDocument.trusted=!t.htmlDocument.trusted,tooltip:r.__(`Whether the HTML file is trusted.\nTrusting the file allows scripts to run in it,\nwhich may result in security risks.\nOnly enable for files you trust.`),label:t.htmlDocument.trusted?r.__("Distrust HTML"):r.__("Trust HTML")})))}t.TrustButtonComponent=e})(x||(x={}))}}]);