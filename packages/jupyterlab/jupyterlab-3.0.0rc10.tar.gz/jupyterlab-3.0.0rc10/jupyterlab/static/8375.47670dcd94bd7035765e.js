(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[8375],{58375:(e,n,t)=>{"use strict";t.r(n);t.d(n,{default:()=>E});var o=t(44626);var r=t(90265);var a=t(53703);var s=t(39193);var l=t(66995);var c=t(99021);var i=t(67674);var d=t(32834);var u=t(21644);var p=t(11368);var f=t(21157);var m=t(29103);var C=t(93269);var v=t(52191);var g=t(58578);var b=t(86992);var h=t(66934);const y={id:"@jupyterlab/console-extension:foreign",requires:[s.IConsoleTracker,p.ISettingRegistry,f.ITranslator],optional:[r.ICommandPalette],activate:x,autoStart:true};const _=y;function x(e,n,t,o,r){const a=o.load("jupyterlab");const{shell:l}=e;n.widgetAdded.connect(((e,n)=>{const o=n.console;const r=new s.ForeignHandler({sessionContext:o.sessionContext,parent:o});k.foreignHandlerProperty.set(o,r);void t.get("@jupyterlab/console-extension:tracker","showAllKernelActivity").then((({composite:e})=>{const n=e;r.enabled=n}));o.disposed.connect((()=>{r.dispose()}))}));const{commands:c}=e;const i=a.__("Console");const d="console:toggle-show-all-kernel-activity";function u(e){const t=n.currentWidget;const o=e["activate"]!==false;if(o&&t){l.activateById(t.id)}return t}c.addCommand(d,{label:e=>a.__("Show All Kernel Activity"),execute:e=>{const n=u(e);if(!n){return}const t=k.foreignHandlerProperty.get(n.console);if(t){t.enabled=!t.enabled}},isToggled:()=>{var e;return n.currentWidget!==null&&!!((e=k.foreignHandlerProperty.get(n.currentWidget.console))===null||e===void 0?void 0:e.enabled)},isEnabled:()=>n.currentWidget!==null&&n.currentWidget===l.currentWidget});if(r){r.addItem({command:d,category:i,args:{isPalette:true}})}e.contextMenu.addItem({command:d,selector:".jp-CodeConsole"})}var k;(function(e){e.foreignHandlerProperty=new h.AttachedProperty({name:"foreignHandler",create:()=>undefined})})(k||(k={}));var w;(function(e){e.create="console:create";e.clear="console:clear";e.runUnforced="console:run-unforced";e.runForced="console:run-forced";e.linebreak="console:linebreak";e.interrupt="console:interrupt-kernel";e.restart="console:restart-kernel";e.closeAndShutdown="console:close-and-shutdown";e.open="console:open";e.inject="console:inject";e.changeKernel="console:change-kernel";e.enterToExecute="console:enter-to-execute";e.shiftEnterToExecute="console:shift-enter-to-execute";e.interactionMode="console:interaction-mode";e.replaceSelection="console:replace-selection"})(w||(w={}));const I={id:"@jupyterlab/console-extension:tracker",provides:s.IConsoleTracker,requires:[s.ConsolePanel.IContentFactory,a.IEditorServices,o.ILayoutRestorer,c.IFileBrowserFactory,u.IRenderMimeRegistry,p.ISettingRegistry,f.ITranslator],optional:[d.IMainMenu,r.ICommandPalette,i.ILauncher,o.ILabStatus,r.ISessionContextDialogs],activate:P,autoStart:true};const M={id:"@jupyterlab/console-extension:factory",provides:s.ConsolePanel.IContentFactory,requires:[a.IEditorServices],autoStart:true,activate:(e,n)=>{const t=n.factoryService.newInlineEditor;return new s.ConsolePanel.ContentFactory({editorFactory:t})}};const S=[M,I,_];const E=S;async function P(e,n,t,o,a,c,i,d,u,p,f,h,y){const _=d.load("jupyterlab");const x=e.serviceManager;const{commands:k,shell:I}=e;const M=_.__("Console");y=y!==null&&y!==void 0?y:r.sessionContextDialogs;const S=new r.WidgetTracker({namespace:"console"});void o.restore(S,{command:w.create,args:e=>{const{path:n,name:t,kernelPreference:o}=e.console.sessionContext;return{path:n,name:t,kernelPreference:Object.assign({},o)}},name:e=>{var n;return(n=e.console.sessionContext.path)!==null&&n!==void 0?n:v.UUID.uuid4()},when:x.ready});if(f){void x.ready.then((()=>{let e=null;const n=()=>{if(e){e.dispose();e=null}const n=x.kernelspecs.specs;if(!n){return}e=new g.DisposableSet;const t=l.PageConfig.getBaseUrl();for(const o in n.kernelspecs){const r=o===n.default?0:Infinity;const a=n.kernelspecs[o];let s=a.resources["logo-64x64"];if(s){const e=s.indexOf("kernelspecs");s=l.URLExt.join(t,s.slice(e))}e.add(f.add({command:w.create,args:{isLauncher:true,kernelPreference:{name:o}},category:_.__("Console"),rank:r,kernelIconUrl:s,metadata:{kernel:v.JSONExt.deepCopy(a.metadata||{})}}))}};n();x.kernelspecs.specsChanged.connect(n)}))}async function E(e){var o;await x.ready;const r=new s.ConsolePanel(Object.assign({manager:x,contentFactory:n,mimeTypeService:t.mimeTypeService,rendermime:c,translator:d,setBusy:(o=h&&(()=>h.setBusy()))!==null&&o!==void 0?o:undefined},e));const a=(await i.get("@jupyterlab/console-extension:tracker","interactionMode")).composite;r.console.node.dataset.jpInteractionMode=a;await S.add(r);r.sessionContext.propertyChanged.connect((()=>{void S.save(r)}));I.add(r,"main",{ref:e.ref,mode:e.insertMode,activate:e.activate!==false});return r}const P="@jupyterlab/console-extension:tracker";let j;async function K(){j=(await i.get(P,"interactionMode")).composite;S.forEach((e=>{e.console.node.dataset.jpInteractionMode=j}))}i.pluginChanged.connect(((e,n)=>{if(n===P){void K()}}));await K();function A(){return S.currentWidget!==null&&S.currentWidget===I.currentWidget}let B=w.open;k.addCommand(B,{execute:e=>{const n=e["path"];const t=S.find((e=>{var t;return((t=e.console.sessionContext.session)===null||t===void 0?void 0:t.path)===n}));if(t){if(e.activate!==false){I.activateById(t.id)}return t}else{return x.ready.then((()=>{const t=(0,C.find)(x.sessions.running(),(e=>e.path===n));if(t){return E(e)}return Promise.reject(`No running kernel session for path: ${n}`)}))}}});B=w.create;k.addCommand(B,{label:e=>{var n,t,o,r;if(e["isPalette"]){return _.__("New Console")}else if(e["isLauncher"]&&e["kernelPreference"]){const a=e["kernelPreference"];return(r=(o=(t=(n=x.kernelspecs)===null||n===void 0?void 0:n.specs)===null||t===void 0?void 0:t.kernelspecs[a.name||""])===null||o===void 0?void 0:o.display_name)!==null&&r!==void 0?r:""}return _.__("Console")},icon:e=>e["isPalette"]?undefined:m.consoleIcon,execute:e=>{const n=e["basePath"]||e["cwd"]||a.defaultBrowser.model.path;return E(Object.assign({basePath:n},e))}});function R(e){const n=S.currentWidget;const t=e["activate"]!==false;if(t&&n){I.activateById(n.id)}return n!==null&&n!==void 0?n:null}k.addCommand(w.clear,{label:_.__("Clear Console Cells"),execute:e=>{const n=R(e);if(!n){return}n.console.clear()},isEnabled:A});k.addCommand(w.runUnforced,{label:_.__("Run Cell (unforced)"),execute:e=>{const n=R(e);if(!n){return}return n.console.execute()},isEnabled:A});k.addCommand(w.runForced,{label:_.__("Run Cell (forced)"),execute:e=>{const n=R(e);if(!n){return}return n.console.execute(true)},isEnabled:A});k.addCommand(w.linebreak,{label:_.__("Insert Line Break"),execute:e=>{const n=R(e);if(!n){return}n.console.insertLinebreak()},isEnabled:A});k.addCommand(w.replaceSelection,{label:_.__("Replace Selection in Console"),execute:e=>{const n=R(e);if(!n){return}const t=e["text"]||"";n.console.replaceSelection(t)},isEnabled:A});k.addCommand(w.interrupt,{label:_.__("Interrupt Kernel"),execute:e=>{var n;const t=R(e);if(!t){return}const o=(n=t.console.sessionContext.session)===null||n===void 0?void 0:n.kernel;if(o){return o.interrupt()}},isEnabled:A});k.addCommand(w.restart,{label:_.__("Restart Kernel…"),execute:e=>{const n=R(e);if(!n){return}return y.restart(n.console.sessionContext,d)},isEnabled:A});k.addCommand(w.closeAndShutdown,{label:_.__("Close and Shut Down…"),execute:e=>{const n=R(e);if(!n){return}return(0,r.showDialog)({title:_.__("Shut down the console?"),body:_.__('Are you sure you want to close "%1"?',n.title.label),buttons:[r.Dialog.cancelButton(),r.Dialog.warnButton()]}).then((e=>{if(e.button.accept){return n.console.sessionContext.shutdown().then((()=>{n.dispose();return true}))}else{return false}}))},isEnabled:A});k.addCommand(w.inject,{execute:e=>{const n=e["path"];S.find((t=>{var o;if(((o=t.console.sessionContext.session)===null||o===void 0?void 0:o.path)===n){if(e["activate"]!==false){I.activateById(t.id)}void t.console.inject(e["code"],e["metadata"]);return true}return false}))},isEnabled:A});k.addCommand(w.changeKernel,{label:_.__("Change Kernel…"),execute:e=>{const n=R(e);if(!n){return}return y.selectKernel(n.console.sessionContext,d)},isEnabled:A});if(p){[w.create,w.linebreak,w.clear,w.runUnforced,w.runForced,w.restart,w.interrupt,w.changeKernel,w.closeAndShutdown].forEach((e=>{p.addItem({command:e,category:M,args:{isPalette:true}})}))}if(u){u.fileMenu.newMenu.addGroup([{command:w.create}],0);u.fileMenu.closeAndCleaners.add({tracker:S,closeAndCleanupLabel:e=>_.__("Shutdown Console"),closeAndCleanup:e=>(0,r.showDialog)({title:_.__("Shut down the Console?"),body:_.__('Are you sure you want to close "%1"?',e.title.label),buttons:[r.Dialog.cancelButton(),r.Dialog.warnButton()]}).then((n=>{if(n.button.accept){return e.console.sessionContext.shutdown().then((()=>{e.dispose()}))}else{return void 0}}))});u.kernelMenu.kernelUsers.add({tracker:S,restartKernelAndClearLabel:e=>_.__("Restart Kernel and Clear Console"),interruptKernel:e=>{var n;const t=(n=e.console.sessionContext.session)===null||n===void 0?void 0:n.kernel;if(t){return t.interrupt()}return Promise.resolve(void 0)},restartKernel:e=>y.restart(e.console.sessionContext,d),restartKernelAndClear:e=>y.restart(e.console.sessionContext).then((n=>{if(n){e.console.clear()}return n})),changeKernel:e=>y.selectKernel(e.console.sessionContext,d),shutdownKernel:e=>e.console.sessionContext.shutdown()});u.runMenu.codeRunners.add({tracker:S,runLabel:e=>_.__("Run Cell"),run:e=>e.console.execute(true)});u.editMenu.clearers.add({tracker:S,clearCurrentLabel:e=>_.__("Clear Console Cell"),clearCurrent:e=>e.console.clear()})}const F={notebook:_.__("Execute with Shift+Enter"),terminal:_.__("Execute with Enter")};k.addCommand(w.interactionMode,{label:e=>F[e["interactionMode"]]||"",execute:async e=>{const n="keyMap";try{await i.set(P,"interactionMode",e["interactionMode"])}catch(t){console.error(`Failed to set ${P}:${n} - ${t.message}`)}},isToggled:e=>e["interactionMode"]===j});const L=new b.Menu({commands:k});L.title.label=_.__("Console Run Keystroke");["terminal","notebook"].forEach((e=>L.addItem({command:w.interactionMode,args:{interactionMode:e}})));if(u){u.settingsMenu.addGroup([{type:"submenu",submenu:L}],10);u.helpMenu.kernelUsers.add({tracker:S,getKernel:e=>{var n;return(n=e.sessionContext.session)===null||n===void 0?void 0:n.kernel}})}e.contextMenu.addItem({command:w.clear,selector:".jp-CodeConsole-content"});e.contextMenu.addItem({command:w.restart,selector:".jp-CodeConsole"});return S}}}]);