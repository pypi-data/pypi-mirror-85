(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[5234],{85234:(e,t,s)=>{"use strict";s.r(t);s.d(t,{BreadCrumbs:()=>v,CHUNK_SIZE:()=>ye,DirListing:()=>ee,FileBrowser:()=>pe,FileBrowserModel:()=>we,FileDialog:()=>Ce,FileUploadStatus:()=>Me,FilenameSearcher:()=>le,FilterFileBrowserModel:()=>Ee,IFileBrowserFactory:()=>_e,LARGE_FILE_SIZE:()=>ve,Uploader:()=>se});var i=s(90265);var n=s(90090);var r=s(29103);var a=s(86992);var o=s(93269);var l=s(85893);var d=s(66995);var h=s(91180);var c=s(21157);const m="jp-BreadCrumbs";const u="jp-BreadCrumbs-home";const p="jp-BreadCrumbs-item";const _=["/","../../","../",""];const f="application/x-jupyter-icontents";const g="jp-mod-dropTarget";class v extends a.Widget{constructor(e){super();this.translator=e.translator||c.nullTranslator;this._trans=this.translator.load("jupyterlab");this._model=e.model;this.addClass(m);this._crumbs=y.createCrumbs();this._crumbSeps=y.createCrumbSeparators();this.node.appendChild(this._crumbs[y.Crumb.Home]);this._model.refreshed.connect(this.update,this)}handleEvent(e){switch(e.type){case"click":this._evtClick(e);break;case"lm-dragenter":this._evtDragEnter(e);break;case"lm-dragleave":this._evtDragLeave(e);break;case"lm-dragover":this._evtDragOver(e);break;case"lm-drop":this._evtDrop(e);break;default:return}}onAfterAttach(e){super.onAfterAttach(e);this.update();const t=this.node;t.addEventListener("click",this);t.addEventListener("lm-dragenter",this);t.addEventListener("lm-dragleave",this);t.addEventListener("lm-dragover",this);t.addEventListener("lm-drop",this)}onBeforeDetach(e){super.onBeforeDetach(e);const t=this.node;t.removeEventListener("click",this);t.removeEventListener("lm-dragenter",this);t.removeEventListener("lm-dragleave",this);t.removeEventListener("lm-dragover",this);t.removeEventListener("lm-drop",this)}onUpdateRequest(e){const t=this._model.manager.services.contents;const s=t.localPath(this._model.path);y.updateCrumbs(this._crumbs,this._crumbSeps,s)}_evtClick(e){if(e.button!==0){return}let t=e.target;while(t&&t!==this.node){if(t.classList.contains(p)||t.classList.contains(u)){const s=o.ArrayExt.findFirstIndex(this._crumbs,(e=>e===t));this._model.cd(_[s]).catch((e=>(0,i.showErrorMessage)(this._trans.__("Open Error"),e)));e.preventDefault();e.stopPropagation();return}t=t.parentElement}}_evtDragEnter(e){if(e.mimeData.hasData(f)){const t=o.ArrayExt.findFirstIndex(this._crumbs,(t=>l.ElementExt.hitTest(t,e.clientX,e.clientY)));if(t!==-1){if(t!==y.Crumb.Current){this._crumbs[t].classList.add(g);e.preventDefault();e.stopPropagation()}}}}_evtDragLeave(e){e.preventDefault();e.stopPropagation();const t=i.DOMUtils.findElement(this.node,g);if(t){t.classList.remove(g)}}_evtDragOver(e){e.preventDefault();e.stopPropagation();e.dropAction=e.proposedAction;const t=i.DOMUtils.findElement(this.node,g);if(t){t.classList.remove(g)}const s=o.ArrayExt.findFirstIndex(this._crumbs,(t=>l.ElementExt.hitTest(t,e.clientX,e.clientY)));if(s!==-1){this._crumbs[s].classList.add(g)}}_evtDrop(e){e.preventDefault();e.stopPropagation();if(e.proposedAction==="none"){e.dropAction="none";return}if(!e.mimeData.hasData(f)){return}e.dropAction=e.proposedAction;let t=e.target;while(t&&t.parentElement){if(t.classList.contains(g)){t.classList.remove(g);break}t=t.parentElement}const s=o.ArrayExt.findFirstIndex(this._crumbs,(e=>e===t));if(s===-1){return}const n=this._model;const r=d.PathExt.resolve(n.path,_[s]);const a=n.manager;const l=[];const c=e.mimeData.getData(f);for(const i of c){const e=a.services.contents.localPath(i);const t=d.PathExt.basename(e);const s=d.PathExt.join(r,t);l.push((0,h.renameFile)(a,i,s))}void Promise.all(l).catch((e=>(0,i.showErrorMessage)(this._trans.__("Move Error"),e)))}}var y;(function(e){let t;(function(e){e[e["Home"]=0]="Home";e[e["Ellipsis"]=1]="Ellipsis";e[e["Parent"]=2]="Parent";e[e["Current"]=3]="Current"})(t=e.Crumb||(e.Crumb={}));function s(e,s,i){const n=e[0].parentNode;const r=n.firstChild;while(r&&r.nextSibling){n.removeChild(r.nextSibling)}n.appendChild(s[0]);const a=i.split("/");if(a.length>2){n.appendChild(e[t.Ellipsis]);const i=a.slice(0,a.length-2).join("/");e[t.Ellipsis].title=i;n.appendChild(s[1])}if(i){if(a.length>=2){e[t.Parent].textContent=a[a.length-2];n.appendChild(e[t.Parent]);const i=a.slice(0,a.length-1).join("/");e[t.Parent].title=i;n.appendChild(s[2])}e[t.Current].textContent=a[a.length-1];n.appendChild(e[t.Current]);e[t.Current].title=i;n.appendChild(s[3])}}e.updateCrumbs=s;function i(){const e=r.folderIcon.element({className:u,tag:"span",title:d.PageConfig.getOption("serverRoot")||"Jupyter Server Root",stylesheet:"breadCrumb"});const t=r.ellipsesIcon.element({className:p,tag:"span",stylesheet:"breadCrumb"});const s=document.createElement("span");s.className=p;const i=document.createElement("span");i.className=p;return[e,t,s,i]}e.createCrumbs=i;function n(){const e=[];const t=2;for(let s=0;s<t+2;s++){const t=document.createElement("span");t.textContent="/";e.push(t)}return e}e.createCrumbSeparators=n})(y||(y={}));var w=s(18834);var E=s(52191);var b=s(12400);var C=s(74723);var D=s(63117);var I=s(74858);const x="jp-DirListing";const L="jp-DirListing-header";const k="jp-DirListing-headerItem";const F="jp-DirListing-headerItemText";const M="jp-DirListing-headerItemIcon";const P="jp-DirListing-content";const N="jp-DirListing-item";const j="jp-DirListing-itemText";const S="jp-DirListing-itemIcon";const T="jp-DirListing-itemModified";const A="jp-DirListing-editor";const O="jp-id-name";const B="jp-id-modified";const R="jp-id-narrow";const U="application/x-jupyter-icontents";const z="application/x-jupyter-icontentsrich";const V="jp-mod-dropTarget";const K="jp-mod-selected";const W="jp-DragIcon";const H="jp-mod-clipboard";const Y="jp-mod-cut";const X="jp-mod-multiSelected";const q="jp-mod-running";const G="jp-mod-descending";const $=1e3;const Z=5;const J=!!navigator.platform.match(/Mac/i);const Q="application/vnd.lumino.widget-factory";class ee extends a.Widget{constructor(e){super({node:(e.renderer||ee.defaultRenderer).createNode()});this._items=[];this._sortedItems=[];this._sortState={direction:"ascending",key:"name"};this._onItemOpened=new D.Signal(this);this._drag=null;this._dragData=null;this._selectTimer=-1;this._isCut=false;this._prevPath="";this._clipboard=[];this._softSelection="";this._selection=Object.create(null);this._searchPrefix="";this._searchPrefixTimer=-1;this._inRename=false;this._isDirty=false;this.addClass(x);this.translator=e.translator||c.nullTranslator;this._trans=this.translator.load("jupyterlab");this._model=e.model;this._model.fileChanged.connect(this._onFileChanged,this);this._model.refreshed.connect(this._onModelRefreshed,this);this._model.pathChanged.connect(this._onPathChanged,this);this._editNode=document.createElement("input");this._editNode.className=A;this._manager=this._model.manager;this._renderer=e.renderer||ee.defaultRenderer;const t=i.DOMUtils.findElement(this.node,L);this._renderer.populateHeaderNode(t,this.translator);this._manager.activateRequested.connect(this._onActivateRequested,this)}dispose(){this._items.length=0;this._sortedItems.length=0;this._clipboard.length=0;super.dispose()}get model(){return this._model}get headerNode(){return i.DOMUtils.findElement(this.node,L)}get contentNode(){return i.DOMUtils.findElement(this.node,P)}get renderer(){return this._renderer}get sortState(){return this._sortState}get onItemOpened(){return this._onItemOpened}selectedItems(){const e=this._sortedItems;return(0,o.filter)(e,(e=>this._selection[e.name]))}sortedItems(){return new o.ArrayIterator(this._sortedItems)}sort(e){this._sortedItems=te.sort(this.model.items(),e);this._sortState=e;this.update()}rename(){return this._doRename()}cut(){this._isCut=true;this._copy();this.update()}copy(){this._copy()}paste(){if(!this._clipboard.length){this._isCut=false;return Promise.resolve(undefined)}const e=this._model.path;const t=[];(0,o.each)(this._clipboard,(s=>{if(this._isCut){const i=s.split("/");const n=i[i.length-1];const r=d.PathExt.join(e,n);t.push(this._model.manager.rename(s,r))}else{t.push(this._model.manager.copy(s,e))}}));(0,o.each)(this._items,(e=>{e.classList.remove(Y)}));this._clipboard.length=0;this._isCut=false;this.removeClass(H);return Promise.all(t).then((()=>undefined)).catch((e=>{void(0,i.showErrorMessage)(this._trans._p("showErrorMessage","Paste Error"),e)}))}async delete(){const e=this._sortedItems.filter((e=>this._selection[e.name]));if(!e.length){return}const t=e.length===1?this._trans.__("Are you sure you want to permanently delete: %1?",e[0].name):this._trans._n("Are you sure you want to permanently delete the %1 selected item?","Are you sure you want to permanently delete the %1 selected items?",e.length);const s=await(0,i.showDialog)({title:this._trans.__("Delete"),body:t,buttons:[i.Dialog.cancelButton({label:this._trans.__("Cancel")}),i.Dialog.warnButton({label:this._trans.__("Delete")})]});if(!this.isDisposed&&s.button.accept){await this._delete(e.map((e=>e.path)))}}duplicate(){const e=this._model.path;const t=[];(0,o.each)(this.selectedItems(),(s=>{if(s.type!=="directory"){const i=d.PathExt.join(e,s.name);t.push(this._model.manager.copy(i,e))}}));return Promise.all(t).then((()=>undefined)).catch((e=>{void(0,i.showErrorMessage)(this._trans._p("showErrorMessage","Duplicate file"),e)}))}async download(){await Promise.all((0,o.toArray)(this.selectedItems()).filter((e=>e.type!=="directory")).map((e=>this._model.download(e.path))))}shutdownKernels(){const e=this._model;const t=this._sortedItems;const s=t.map((e=>e.path));const n=(0,o.toArray)(this._model.sessions()).filter((e=>{const i=o.ArrayExt.firstIndexOf(s,e.path);return this._selection[t[i].name]})).map((t=>e.manager.services.sessions.shutdown(t.id)));return Promise.all(n).then((()=>undefined)).catch((e=>{void(0,i.showErrorMessage)(this._trans._p("showErrorMessage","Shut down kernel"),e)}))}selectNext(e=false){let t=-1;const s=Object.keys(this._selection);const i=this._sortedItems;if(s.length===1||e){const e=s[s.length-1];t=o.ArrayExt.findFirstIndex(i,(t=>t.name===e));t+=1;if(t===this._items.length){t=0}}else if(s.length===0){t=0}else{const e=s[s.length-1];t=o.ArrayExt.findFirstIndex(i,(t=>t.name===e))}if(t!==-1){this._selectItem(t,e);l.ElementExt.scrollIntoViewIfNeeded(this.contentNode,this._items[t])}}selectPrevious(e=false){let t=-1;const s=Object.keys(this._selection);const i=this._sortedItems;if(s.length===1||e){const e=s[0];t=o.ArrayExt.findFirstIndex(i,(t=>t.name===e));t-=1;if(t===-1){t=this._items.length-1}}else if(s.length===0){t=this._items.length-1}else{const e=s[0];t=o.ArrayExt.findFirstIndex(i,(t=>t.name===e))}if(t!==-1){this._selectItem(t,e);l.ElementExt.scrollIntoViewIfNeeded(this.contentNode,this._items[t])}}selectByPrefix(){const e=this._searchPrefix.toLowerCase();const t=this._sortedItems;const s=o.ArrayExt.findFirstIndex(t,(t=>t.name.toLowerCase().substr(0,e.length)===e));if(s!==-1){this._selectItem(s,false);l.ElementExt.scrollIntoViewIfNeeded(this.contentNode,this._items[s])}}isSelected(e){return this._selection[e]===true}modelForClick(e){const t=this._sortedItems;const s=te.hitTestNodes(this._items,e);if(s!==-1){return t[s]}return undefined}clearSelectedItems(){this._selection=Object.create(null)}async selectItemByName(e){await this.model.refresh();if(this.isDisposed){throw new Error("File browser is disposed.")}const t=this._sortedItems;const s=o.ArrayExt.findFirstIndex(t,(t=>t.name===e));if(s===-1){throw new Error("Item does not exist.")}this._selectItem(s,false);C.MessageLoop.sendMessage(this,a.Widget.Msg.UpdateRequest);l.ElementExt.scrollIntoViewIfNeeded(this.contentNode,this._items[s])}handleEvent(e){switch(e.type){case"mousedown":this._evtMousedown(e);break;case"mouseup":this._evtMouseup(e);break;case"mousemove":this._evtMousemove(e);break;case"keydown":this._evtKeydown(e);break;case"click":this._evtClick(e);break;case"dblclick":this._evtDblClick(e);break;case"dragenter":case"dragover":this.addClass("jp-mod-native-drop");e.preventDefault();break;case"dragleave":case"dragend":this.removeClass("jp-mod-native-drop");break;case"drop":this.removeClass("jp-mod-native-drop");this._evtNativeDrop(e);break;case"scroll":this._evtScroll(e);break;case"lm-dragenter":this._evtDragEnter(e);break;case"lm-dragleave":this._evtDragLeave(e);break;case"lm-dragover":this._evtDragOver(e);break;case"lm-drop":this._evtDrop(e);break;default:break}}onAfterAttach(e){super.onAfterAttach(e);const t=this.node;const s=i.DOMUtils.findElement(t,P);t.addEventListener("mousedown",this);t.addEventListener("keydown",this);t.addEventListener("click",this);t.addEventListener("dblclick",this);s.addEventListener("dragenter",this);s.addEventListener("dragover",this);s.addEventListener("dragleave",this);s.addEventListener("dragend",this);s.addEventListener("drop",this);s.addEventListener("scroll",this);s.addEventListener("lm-dragenter",this);s.addEventListener("lm-dragleave",this);s.addEventListener("lm-dragover",this);s.addEventListener("lm-drop",this)}onBeforeDetach(e){super.onBeforeDetach(e);const t=this.node;const s=i.DOMUtils.findElement(t,P);t.removeEventListener("mousedown",this);t.removeEventListener("keydown",this);t.removeEventListener("click",this);t.removeEventListener("dblclick",this);s.removeEventListener("scroll",this);s.removeEventListener("dragover",this);s.removeEventListener("dragover",this);s.removeEventListener("dragleave",this);s.removeEventListener("dragend",this);s.removeEventListener("drop",this);s.removeEventListener("lm-dragenter",this);s.removeEventListener("lm-dragleave",this);s.removeEventListener("lm-dragover",this);s.removeEventListener("lm-drop",this);document.removeEventListener("mousemove",this,true);document.removeEventListener("mouseup",this,true)}onAfterShow(e){if(this._isDirty){this.sort(this.sortState);this.update()}}onUpdateRequest(e){this._isDirty=false;const t=this._sortedItems;const s=this._items;const n=i.DOMUtils.findElement(this.node,P);const r=this._renderer;this.removeClass(X);this.removeClass(K);while(s.length>t.length){n.removeChild(s.pop())}while(s.length<t.length){const e=r.createItemNode();e.classList.add(N);s.push(e);n.appendChild(e)}s.forEach((e=>{e.classList.remove(K);e.classList.remove(q);e.classList.remove(Y)}));t.forEach(((e,t)=>{const i=s[t];const n=this._manager.registry.getFileTypeForModel(e);r.updateItemNode(i,e,n,this.translator);if(this._selection[e.name]){i.classList.add(K);if(this._isCut&&this._model.path===this._prevPath){i.classList.add(Y)}}i.setAttribute("data-isdir",e.type==="directory"?"true":"false")}));const a=Object.keys(this._selection).length;if(a){this.addClass(K);if(a>1){this.addClass(X)}}const l=t.map((e=>e.path));(0,o.each)(this._model.sessions(),(e=>{var t;const i=o.ArrayExt.firstIndexOf(l,e.path);const n=s[i];if(n){let s=(t=e.kernel)===null||t===void 0?void 0:t.name;const i=this._model.specs;n.classList.add(q);if(i&&s){const e=i.kernelspecs[s];s=e?e.display_name:"unknown"}n.title=this._trans.__("%1\nKernel: %2",n.title,s)}}));this._prevPath=this._model.path}onResize(e){const{width:t}=e.width===-1?this.node.getBoundingClientRect():e;this.toggleClass("jp-DirListing-narrow",t<250)}_evtClick(e){const t=e.target;const s=this.headerNode;if(s.contains(t)){const t=this.renderer.handleHeaderClick(s,e);if(t){this.sort(t)}return}}_evtScroll(e){this.headerNode.scrollLeft=this.contentNode.scrollLeft}_evtMousedown(e){if(e.target===this._editNode){return}if(this._editNode.parentNode){if(this._editNode!==e.target){this._editNode.focus();this._editNode.blur();clearTimeout(this._selectTimer)}else{return}}let t=te.hitTestNodes(this._items,e);if(t===-1){return}this._handleFileSelect(e);if(e.button!==0){clearTimeout(this._selectTimer)}const s=J&&e.ctrlKey||e.button===2;if(s){return}if(e.button===0){this._dragData={pressX:e.clientX,pressY:e.clientY,index:t};document.addEventListener("mouseup",this,true);document.addEventListener("mousemove",this,true)}}_evtMouseup(e){if(this._softSelection){const t=e.metaKey||e.shiftKey||e.ctrlKey;if(!t&&e.button===0){this.clearSelectedItems();this._selection[this._softSelection]=true;this.update()}this._softSelection=""}if(e.button!==0||!this._drag){document.removeEventListener("mousemove",this,true);document.removeEventListener("mouseup",this,true);return}e.preventDefault();e.stopPropagation()}_evtMousemove(e){e.preventDefault();e.stopPropagation();if(this._drag||!this._dragData){return}const t=this._dragData;const s=Math.abs(e.clientX-t.pressX);const i=Math.abs(e.clientY-t.pressY);if(s<Z&&i<Z){return}this._startDrag(t.index,e.clientX,e.clientY)}_handleOpen(e){this._onItemOpened.emit(e);if(e.type==="directory"){const t=this._manager.services.contents.localPath(e.path);this._model.cd(`/${t}`).catch((e=>(0,i.showErrorMessage)(this._trans._p("showErrorMessage","Open directory"),e)))}else{const t=e.path;this._manager.openOrReveal(t,"default",undefined,{maybeNewWorkspace:true})}}_evtKeydown(e){switch(e.keyCode){case 13:{if(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey){return}e.preventDefault();e.stopPropagation();const t=Object.keys(this._selection);const s=t[0];const i=this._sortedItems;const n=o.ArrayExt.findFirstIndex(i,(e=>e.name===s));if(n===-1){return}const r=this._sortedItems[n];this._handleOpen(r);break}case 38:this.selectPrevious(e.shiftKey);e.stopPropagation();e.preventDefault();break;case 40:this.selectNext(e.shiftKey);e.stopPropagation();e.preventDefault();break;default:break}if(!this._inRename&&e.key!==undefined&&e.key.length===1){this._searchPrefix+=e.key;clearTimeout(this._searchPrefixTimer);this._searchPrefixTimer=window.setTimeout((()=>{this._searchPrefix=""}),$);this.selectByPrefix();e.stopPropagation();e.preventDefault()}}_evtDblClick(e){if(e.button!==0){return}if(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey){return}e.preventDefault();e.stopPropagation();clearTimeout(this._selectTimer);this._editNode.blur();const t=e.target;const s=o.ArrayExt.findFirstIndex(this._items,(e=>e.contains(t)));if(s===-1){return}const i=this._sortedItems[s];this._handleOpen(i)}_evtNativeDrop(e){var t;const s=(t=e.dataTransfer)===null||t===void 0?void 0:t.files;if(!s||s.length===0){return}e.preventDefault();for(let i=0;i<s.length;i++){void this._model.upload(s[i])}}_evtDragEnter(e){if(e.mimeData.hasData(U)){const t=te.hitTestNodes(this._items,e);if(t===-1){return}const s=this._sortedItems[t];if(s.type!=="directory"||this._selection[s.name]){return}const i=e.target;i.classList.add(V);e.preventDefault();e.stopPropagation()}}_evtDragLeave(e){e.preventDefault();e.stopPropagation();const t=i.DOMUtils.findElement(this.node,V);if(t){t.classList.remove(V)}}_evtDragOver(e){e.preventDefault();e.stopPropagation();e.dropAction=e.proposedAction;const t=i.DOMUtils.findElement(this.node,V);if(t){t.classList.remove(V)}const s=te.hitTestNodes(this._items,e);this._items[s].classList.add(V)}_evtDrop(e){e.preventDefault();e.stopPropagation();clearTimeout(this._selectTimer);if(e.proposedAction==="none"){e.dropAction="none";return}if(!e.mimeData.hasData(U)){return}let t=e.target;while(t&&t.parentElement){if(t.classList.contains(V)){t.classList.remove(V);break}t=t.parentElement}const s=o.ArrayExt.firstIndexOf(this._items,t);const n=this._sortedItems;let r=this._model.path;if(n[s].type==="directory"){r=d.PathExt.join(r,n[s].name)}const a=this._manager;const l=[];const c=e.mimeData.getData(U);if(e.ctrlKey&&e.proposedAction==="move"){e.dropAction="copy"}else{e.dropAction=e.proposedAction}for(const i of c){const t=a.services.contents.localPath(i);const s=d.PathExt.basename(t);const n=d.PathExt.join(r,s);if(n===i){continue}if(e.dropAction==="copy"){l.push(a.copy(i,r))}else{l.push((0,h.renameFile)(a,i,n))}}Promise.all(l).catch((e=>{void(0,i.showErrorMessage)(this._trans._p("showErrorMessage","Error while copying/moving files"),e)}))}_startDrag(e,t,s){let i=Object.keys(this._selection);const n=this._items[e];const r=this._sortedItems;let a;let l;if(!n.classList.contains(K)){l=r[e];i=[l.name];a=[l]}else{const e=i[0];l=(0,o.find)(r,(t=>t.name===e));a=(0,o.toArray)(this.selectedItems())}if(!l){return}const h=this._manager.registry.getFileTypeForModel(l);const c=this.renderer.createDragImage(n,i.length,this._trans,h);this._drag=new b.Drag({dragImage:c,mimeData:new E.MimeData,supportedActions:"move",proposedAction:"move"});const m=this._model.path;const u=(0,o.toArray)((0,o.map)(i,(e=>d.PathExt.join(m,e))));this._drag.mimeData.setData(U,u);const p=this.model.manager.services;for(const o of a){this._drag.mimeData.setData(z,{model:o,withContent:async()=>await p.contents.get(o.path)})}if(l&&l.type!=="directory"){const e=u.slice(1).reverse();this._drag.mimeData.setData(Q,(()=>{if(!l){return}const t=l.path;let s=this._manager.findWidget(t);if(!s){s=this._manager.open(l.path)}if(e.length){const t=new E.PromiseDelegate;void t.promise.then((()=>{let t=s;e.forEach((e=>{const s={ref:t===null||t===void 0?void 0:t.id,mode:"tab-after"};t=this._manager.openOrReveal(e,void 0,void 0,s);this._manager.openOrReveal(l.path)}))}));t.resolve(void 0)}return s}))}document.removeEventListener("mousemove",this,true);document.removeEventListener("mouseup",this,true);clearTimeout(this._selectTimer);void this._drag.start(t,s).then((e=>{this._drag=null;clearTimeout(this._selectTimer)}))}_handleFileSelect(e){const t=this._sortedItems;const s=te.hitTestNodes(this._items,e);clearTimeout(this._selectTimer);if(s===-1){return}this._softSelection="";const i=t[s].name;const n=Object.keys(this._selection);if(J&&e.metaKey||!J&&e.ctrlKey){if(this._selection[i]){delete this._selection[i]}else{this._selection[i]=true}}else if(e.shiftKey){this._handleMultiSelect(n,s)}else if(i in this._selection&&n.length>1){this._softSelection=i}else{this.clearSelectedItems();this._selection[i]=true}this.update()}_handleMultiSelect(e,t){const s=this._sortedItems;let i=-1;for(let n=0;n<this._items.length;n++){if(n===t){continue}const r=s[n].name;if(e.indexOf(r)!==-1){if(i===-1){i=n}else{if(Math.abs(t-n)<Math.abs(i-n)){i=n}}}}if(i===-1){i=0}for(let n=0;n<this._items.length;n++){if(i>=n&&t<=n||i<=n&&t>=n){this._selection[s[n].name]=true}}}_copy(){this._clipboard.length=0;(0,o.each)(this.selectedItems(),(e=>{this._clipboard.push(e.path)}))}async _delete(e){await Promise.all(e.map((e=>this._model.manager.deleteFile(e).catch((e=>{void(0,i.showErrorMessage)(this._trans._p("showErrorMessage","Delete Failed"),e)})))))}_doRename(){this._inRename=true;const e=this._sortedItems;const t=Object.keys(this._selection)[0];const s=o.ArrayExt.findFirstIndex(e,(e=>e.name===t));const n=this._items[s];const r=e[s];const a=this.renderer.getNameNode(n);const l=r.name;this._editNode.value=l;this._selectItem(s,false);return te.doRename(a,this._editNode).then((e=>{this.node.focus();if(!e||e===l){this._inRename=false;return l}if(!(0,h.isValidFileName)(e)){void(0,i.showErrorMessage)(this._trans.__("showErrorMessage","Rename Error"),Error(this._trans._p("showErrorMessage",'"%1" is not a valid name for a file. Names must have nonzero length, and cannot include "/", "\\", or ":"',e)));this._inRename=false;return l}if(this.isDisposed){this._inRename=false;throw new Error("File browser is disposed.")}const t=this._manager;const s=d.PathExt.join(this._model.path,l);const n=d.PathExt.join(this._model.path,e);const r=(0,h.renameFile)(t,s,n);return r.catch((e=>{if(e!=="File not renamed"){void(0,i.showErrorMessage)(this._trans._p("showErrorMessage","Rename Error"),e)}this._inRename=false;return l})).then((()=>{if(this.isDisposed){this._inRename=false;throw new Error("File browser is disposed.")}if(this._inRename){void this.selectItemByName(e)}this._inRename=false;return e}))}))}_selectItem(e,t){const s=this._sortedItems;if(!t){this.clearSelectedItems()}const i=s[e].name;this._selection[i]=true;this.update()}_onModelRefreshed(){const e=Object.keys(this._selection);this.clearSelectedItems();(0,o.each)(this._model.items(),(t=>{const s=t.name;if(e.indexOf(s)!==-1){this._selection[s]=true}}));if(this.isVisible){this.sort(this.sortState)}else{this._isDirty=true}}_onPathChanged(){this.clearSelectedItems();this.sort(this.sortState)}_onFileChanged(e,t){const s=t.newValue;if(!s){return}const i=s.name;if(t.type!=="new"||!i){return}void this.selectItemByName(i).then((()=>{if(!this.isDisposed&&s.type==="directory"){return this._doRename()}})).catch((()=>{}))}_onActivateRequested(e,t){const s=d.PathExt.dirname(t);if(s!==this._model.path){return}const i=d.PathExt.basename(t);this.selectItemByName(i).catch((()=>{}))}}(function(e){class t{createNode(){const e=document.createElement("div");const t=document.createElement("div");const s=document.createElement("ul");s.className=P;t.className=L;e.appendChild(t);e.appendChild(s);e.tabIndex=1;return e}populateHeaderNode(e,t){t=t||c.nullTranslator;const s=t.load("jupyterlab");const n=this._createHeaderItemNode(s.__("Name"));const r=document.createElement("div");const a=this._createHeaderItemNode(s.__("Last Modified"));n.classList.add(O);n.classList.add(K);a.classList.add(B);r.classList.add(R);r.textContent="...";e.appendChild(n);e.appendChild(r);e.appendChild(a);te.updateCaret(i.DOMUtils.findElement(n,M),"right","up")}handleHeaderClick(e,t){const s=i.DOMUtils.findElement(e,O);const n=i.DOMUtils.findElement(e,B);const r={direction:"ascending",key:"name"};const a=t.target;if(s.contains(a)){const e=i.DOMUtils.findElement(n,M);const t=i.DOMUtils.findElement(s,M);if(s.classList.contains(K)){if(!s.classList.contains(G)){r.direction="descending";s.classList.add(G);te.updateCaret(t,"right","down")}else{s.classList.remove(G);te.updateCaret(t,"right","up")}}else{s.classList.remove(G);te.updateCaret(t,"right","up")}s.classList.add(K);n.classList.remove(K);n.classList.remove(G);te.updateCaret(e,"left");return r}if(n.contains(a)){const e=i.DOMUtils.findElement(n,M);const t=i.DOMUtils.findElement(s,M);r.key="last_modified";if(n.classList.contains(K)){if(!n.classList.contains(G)){r.direction="descending";n.classList.add(G);te.updateCaret(e,"left","down")}else{n.classList.remove(G);te.updateCaret(e,"left","up")}}else{n.classList.remove(G);te.updateCaret(e,"left","up")}n.classList.add(K);s.classList.remove(K);s.classList.remove(G);te.updateCaret(t,"right");return r}return r}createItemNode(){const e=document.createElement("li");const t=document.createElement("span");const s=document.createElement("span");const i=document.createElement("span");t.className=S;s.className=j;i.className=T;e.appendChild(t);e.appendChild(s);e.appendChild(i);return e}updateItemNode(e,t,s,n){n=n||c.nullTranslator;s=s||w.DocumentRegistry.getDefaultTextFileType(n);const{icon:a,iconClass:l,name:h}=s;n=n||c.nullTranslator;const m=n.load("jupyterlab");const u=i.DOMUtils.findElement(e,S);const p=i.DOMUtils.findElement(e,j);const _=i.DOMUtils.findElement(e,T);r.LabIcon.resolveElement({icon:a,iconClass:(0,r.classes)(l,"jp-Icon"),container:u,className:S,stylesheet:"listing"});let f=m.__("Name: %1",t.name);if(t.size!==null&&t.size!==undefined){f+=m.__("\nSize: %1",te.formatFileSize(t.size,1,1024))}if(t.path){const e=d.PathExt.dirname(t.path);if(e){f+=m.__("\nPath: %1",e.substr(0,50));if(e.length>50){f+="..."}}}if(t.created){f+=m.__("\nCreated: %1",d.Time.format(new Date(t.created),"YYYY-MM-DD HH:mm:ss"))}if(t.last_modified){f+=m.__("\nModified: %1",d.Time.format(new Date(t.last_modified),"YYYY-MM-DD HH:mm:ss"))}f+=m.__("\nWritable: %1",t.writable);e.title=f;e.setAttribute("data-file-type",h);if(t.name.startsWith(".")){e.setAttribute("data-is-dot","true")}else{e.removeAttribute("data-is-dot")}if(p){const e=!t.indices?[]:t.indices;let s=o.StringExt.highlight(t.name,e,I.h.mark);I.VirtualDOM.render(I.h.span(s),p)}let g="";let v="";if(t.last_modified){g=d.Time.formatHuman(new Date(t.last_modified));v=d.Time.format(new Date(t.last_modified),"lll")}_.textContent=g;_.title=v}getNameNode(e){return i.DOMUtils.findElement(e,j)}createDragImage(e,t,s,n){const r=e.cloneNode(true);const a=i.DOMUtils.findElement(r,T);const o=i.DOMUtils.findElement(r,S);r.removeChild(a);if(!n){o.textContent="";o.className=""}else{o.textContent=n.iconLabel||"";o.className=n.iconClass||""}o.classList.add(W);if(t>1){const e=i.DOMUtils.findElement(r,j);e.textContent=s._n("%1 Item","%1 Items",t)}return r}_createHeaderItemNode(e){const t=document.createElement("div");const s=document.createElement("span");const i=document.createElement("span");t.className=k;s.className=F;i.className=M;s.textContent=e;t.appendChild(s);t.appendChild(i);return t}}e.Renderer=t;e.defaultRenderer=new t})(ee||(ee={}));var te;(function(e){function t(e,t){const s=e.parentElement;s.replaceChild(t,e);t.focus();const i=t.value.lastIndexOf(".");if(i===-1){t.setSelectionRange(0,t.value.length)}else{t.setSelectionRange(0,i)}return new Promise(((i,n)=>{t.onblur=()=>{s.replaceChild(e,t);i(t.value)};t.onkeydown=e=>{switch(e.keyCode){case 13:e.stopPropagation();e.preventDefault();t.blur();break;case 27:e.stopPropagation();e.preventDefault();t.blur();break;case 38:e.stopPropagation();e.preventDefault();if(t.selectionStart!==t.selectionEnd){t.selectionStart=t.selectionEnd=0}break;case 40:e.stopPropagation();e.preventDefault();if(t.selectionStart!==t.selectionEnd){t.selectionStart=t.selectionEnd=t.value.length}break;default:break}}}))}e.doRename=t;function s(e,t){const s=(0,o.toArray)(e);const i=t.direction==="descending"?1:-1;if(t.key==="last_modified"){s.sort(((e,t)=>{const s=e.type==="directory"?0:1;const n=t.type==="directory"?0:1;const r=new Date(e.last_modified).getTime();const a=new Date(t.last_modified).getTime();return s-n||(r-a)*i}))}else{s.sort(((e,t)=>{const s=e.type==="directory"?0:1;const n=t.type==="directory"?0:1;return s-n||t.name.localeCompare(e.name)*i}))}return s}e.sort=s;function i(e,t){return o.ArrayExt.findFirstIndex(e,(e=>l.ElementExt.hitTest(e,t.clientX,t.clientY)||t.target===e))}e.hitTestNodes=i;function n(e,t,s){if(e===0){return"0 Bytes"}const i=t||2;const n=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];const r=Math.floor(Math.log(e)/Math.log(s));if(r>=0&&r<n.length){return parseFloat((e/Math.pow(s,r)).toFixed(i))+" "+n[r]}else{return String(e)}}e.formatFileSize=n;function a(e,t,s){if(s){(s==="down"?r.caretDownIcon:r.caretUpIcon).element({container:e,tag:"span",stylesheet:"listingHeaderItem",float:t})}else{r.LabIcon.remove(e);e.className=M}}e.updateCaret=a})(te||(te={}));class se extends i.ToolbarButton{constructor(e){super({icon:r.fileUploadIcon,onClick:()=>{this._input.click()},tooltip:ie.translateToolTip(e.translator)});this._onInputChanged=()=>{const e=Array.prototype.slice.call(this._input.files);const t=e.map((e=>this.fileBrowserModel.upload(e)));void Promise.all(t).catch((e=>{void(0,i.showErrorMessage)(this._trans._p("showErrorMessage","Upload Error"),e)}))};this._onInputClicked=()=>{this._input.value=""};this._input=ie.createUploadInput();this.fileBrowserModel=e.model;this.translator=e.translator||c.nullTranslator;this._trans=this.translator.load("jupyterlab");this._input.onclick=this._onInputClicked;this._input.onchange=this._onInputChanged;this.addClass("jp-id-upload")}}var ie;(function(e){function t(){const e=document.createElement("input");e.type="file";e.multiple=true;return e}e.createUploadInput=t;function s(e){e=e||c.nullTranslator;const t=e.load("jupyterlab");return t.__("Upload Files")}e.translateToolTip=s})(ie||(ie={}));var ne=s(77865);var re=s.n(ne);function ae(e,t){let s=`${e.name}`;let i=Infinity;let n=null;const r=/\b\w/g;let a=true;while(a){let e=r.exec(s);if(!e){break}let a=o.StringExt.matchSumOfDeltas(s,t,e.index);if(!a){break}if(a&&a.score<=i){i=a.score;n=a.indices}}if(!n||i===Infinity){return null}return{score:i,indices:n,item:e}}const oe=e=>{const[t,s]=(0,ne.useState)("");if(e.forceRefresh){(0,ne.useEffect)((()=>{e.listing.model.setFilter((e=>true))}),[])}const i=t=>{const i=t.target;s(i.value);e.listing.model.setFilter((t=>{if(e.useFuzzyFilter){let e=ae(t,i.value);if(!e){t.indices=[];return false}t.indices=e.indices;return true}const s=t.name.indexOf(i.value);if(s===-1){t.indices=[];return false}t.indices=[...Array(i.value.length).keys()].map((e=>e+s));return true}))};return re().createElement(r.InputGroup,{type:"text",rightIcon:"ui-components:search",placeholder:e.placeholder,onChange:i,value:t})};const le=e=>i.ReactWidget.create(re().createElement(oe,{listing:e.listing,useFuzzyFilter:e.useFuzzyFilter,placeholder:e.placeholder,forceRefresh:e.forceRefresh}));const de="jp-FileBrowser";const he="jp-FileBrowser-crumbs";const ce="jp-FileBrowser-filterBox";const me="jp-FileBrowser-toolbar";const ue="jp-FileBrowser-listing";class pe extends a.Widget{constructor(e){super();this._useFuzzyFilter=true;this.addClass(de);this.id=e.id;const t=this.model=e.model;const s=e.renderer;const n=this.translator;t.connectionFailure.connect(this._onConnectionFailure,this);this.translator=e.translator||c.nullTranslator;this._manager=t.manager;this._trans=this.translator.load("jupyterlab");this._crumbs=new v({model:t,translator:n});this.toolbar=new i.Toolbar;this._directoryPending=false;const o=new i.ToolbarButton({icon:r.newFolderIcon,onClick:()=>{this.createNewDirectory()},tooltip:this._trans.__("New Folder")});const l=new se({model:t,translator:this.translator});const d=new i.ToolbarButton({icon:r.refreshIcon,onClick:()=>{void t.refresh()},tooltip:this._trans.__("Refresh File List")});this.toolbar.addItem("newFolder",o);this.toolbar.addItem("upload",l);this.toolbar.addItem("refresher",d);this._listing=new ee({model:t,renderer:s,translator:this.translator});this._filenameSearcher=le({listing:this._listing,useFuzzyFilter:this._useFuzzyFilter,placeholder:this._trans.__("Filter files by name")});this._crumbs.addClass(he);this.toolbar.addClass(me);this._filenameSearcher.addClass(ce);this._listing.addClass(ue);this.layout=new a.PanelLayout;this.layout.addWidget(this.toolbar);this.layout.addWidget(this._filenameSearcher);this.layout.addWidget(this._crumbs);this.layout.addWidget(this._listing);if(e.restore!==false){void t.restore(this.id)}}get navigateToCurrentDirectory(){return this._navigateToCurrentDirectory}set navigateToCurrentDirectory(e){this._navigateToCurrentDirectory=e}set useFuzzyFilter(e){this._useFuzzyFilter=e;this._filenameSearcher=le({listing:this._listing,useFuzzyFilter:this._useFuzzyFilter,placeholder:this._trans.__("Filter files by name"),forceRefresh:true});this._filenameSearcher.addClass(ce);this.layout.removeWidget(this._filenameSearcher);this.layout.removeWidget(this._crumbs);this.layout.removeWidget(this._listing);this.layout.addWidget(this._filenameSearcher);this.layout.addWidget(this._crumbs);this.layout.addWidget(this._listing)}selectedItems(){return this._listing.selectedItems()}async selectItemByName(e){await this._listing.selectItemByName(e)}clearSelectedItems(){this._listing.clearSelectedItems()}rename(){return this._listing.rename()}cut(){this._listing.cut()}copy(){this._listing.copy()}paste(){return this._listing.paste()}createNewDirectory(){if(this._directoryPending===true){return}this._directoryPending=true;void this._manager.newUntitled({path:this.model.path,type:"directory"}).then((async e=>{await this._listing.selectItemByName(e.name);this._directoryPending=false})).catch((e=>{this._directoryPending=false}))}delete(){return this._listing.delete()}duplicate(){return this._listing.duplicate()}download(){return this._listing.download()}shutdownKernels(){return this._listing.shutdownKernels()}selectNext(){this._listing.selectNext()}selectPrevious(){this._listing.selectPrevious()}modelForClick(e){return this._listing.modelForClick(e)}_onConnectionFailure(e,t){if(t instanceof n.ServerConnection.ResponseError&&t.response.status===404){const e=this._trans.__("Directory not found");t.message=this._trans.__('Directory not found: "%1"',this.model.path);void(0,i.showErrorMessage)(e,t)}}}const _e=new E.Token("@jupyterlab/filebrowser:IFileBrowserFactory");var fe=s(56078);const ge=1e4;const ve=15*1024*1024;const ye=1024*1024;class we{constructor(e){var t;this._connectionFailure=new D.Signal(this);this._fileChanged=new D.Signal(this);this._items=[];this._key="";this._pathChanged=new D.Signal(this);this._paths=new Set;this._pending=null;this._pendingPath=null;this._refreshed=new D.Signal(this);this._sessions=[];this._state=null;this._isDisposed=false;this._restored=new E.PromiseDelegate;this._uploads=[];this._uploadChanged=new D.Signal(this);this.manager=e.manager;this.translator=e.translator||c.nullTranslator;this._trans=this.translator.load("jupyterlab");this._driveName=e.driveName||"";const s=this._driveName?this._driveName+":":"";this._model={path:s,name:d.PathExt.basename(s),type:"directory",content:undefined,writable:false,created:"unknown",last_modified:"unknown",mimetype:"text/plain",format:"text"};this._state=e.state||null;const i=e.refreshInterval||ge;const{services:n}=e.manager;n.contents.fileChanged.connect(this._onFileChanged,this);n.sessions.runningChanged.connect(this._onRunningChanged,this);this._unloadEventListener=e=>{if(this._uploads.length>0){const t=this._trans.__("Files still uploading");e.returnValue=t;return t}};window.addEventListener("beforeunload",this._unloadEventListener);this._poll=new fe.Poll({auto:(t=e.auto)!==null&&t!==void 0?t:true,name:"@jupyterlab/filebrowser:Model",factory:()=>this.cd("."),frequency:{interval:i,backoff:true,max:300*1e3},standby:"when-hidden"})}get connectionFailure(){return this._connectionFailure}get driveName(){return this._driveName}get restored(){return this._restored.promise}get fileChanged(){return this._fileChanged}get path(){return this._model?this._model.path:""}get pathChanged(){return this._pathChanged}get refreshed(){return this._refreshed}get specs(){return this.manager.services.kernelspecs.specs}get isDisposed(){return this._isDisposed}get uploadChanged(){return this._uploadChanged}uploads(){return new o.ArrayIterator(this._uploads)}dispose(){if(this.isDisposed){return}window.removeEventListener("beforeunload",this._unloadEventListener);this._isDisposed=true;this._poll.dispose();this._sessions.length=0;this._items.length=0;D.Signal.clearData(this)}items(){return new o.ArrayIterator(this._items)}sessions(){return new o.ArrayIterator(this._sessions)}async refresh(){await this._poll.refresh();await this._poll.tick;this._refreshed.emit(void 0)}async cd(e="."){if(e!=="."){e=this.manager.services.contents.resolvePath(this._model.path,e)}else{e=this._pendingPath||this._model.path}if(this._pending){if(e===this._pendingPath){return this._pending}await this._pending}const t=this.path;const s={content:true};this._pendingPath=e;if(t!==e){this._sessions.length=0}const i=this.manager.services;this._pending=i.contents.get(e,s).then((s=>{if(this.isDisposed){return}this._handleContents(s);this._pendingPath=null;this._pending=null;if(t!==e){if(this._state&&this._key){void this._state.save(this._key,{path:e})}this._pathChanged.emit({name:"path",oldValue:t,newValue:e})}this._onRunningChanged(i.sessions,i.sessions.running());this._refreshed.emit(void 0)})).catch((e=>{this._pendingPath=null;this._pending=null;if(e.response&&e.response.status===404){e.message=this._trans.__('Directory not found: "%1"',this._model.path);console.error(e);this._connectionFailure.emit(e);return this.cd("/")}else{this._connectionFailure.emit(e)}}));return this._pending}async download(e){const t=await this.manager.services.contents.getDownloadUrl(e);const s=document.createElement("a");s.href=t;s.download="";document.body.appendChild(s);s.click();document.body.removeChild(s);return void 0}async restore(e,t=true){const{manager:s}=this;const i=`file-browser-${e}:cwd`;const n=this._state;const r=!!this._key;if(r){return}this._key=i;if(!t||!n){this._restored.resolve(undefined);return}await s.services.ready;try{const e=await n.fetch(i);if(!e){this._restored.resolve(undefined);return}const t=e["path"];const r=s.services.contents.localPath(t);await s.services.contents.get(t);await this.cd(r)}catch(a){await n.remove(i)}this._restored.resolve(undefined)}async upload(e){const t=d.PageConfig.getNotebookVersion()>=[5,1,0];const s=e.size>ve;if(s&&!t){const t=this._trans.__("Cannot upload file (>%1 MB). %2",ve/(1024*1024),e.name);console.warn(t);throw t}const i="File not uploaded";if(s&&!(await this._shouldUploadLarge(e))){throw"Cancelled large file upload"}await this._uploadCheckDisposed();await this.refresh();await this._uploadCheckDisposed();if((0,o.find)(this._items,(t=>t.name===e.name))&&!(await(0,h.shouldOverwrite)(e.name))){throw i}await this._uploadCheckDisposed();const n=t&&e.size>ye;return await this._upload(e,n)}async _shouldUploadLarge(e){const{button:t}=await(0,i.showDialog)({title:this._trans.__("Large file size warning"),body:this._trans.__("The file size is %1 MB. Do you still want to upload it?",Math.round(e.size/(1024*1024))),buttons:[i.Dialog.cancelButton({label:this._trans.__("Cancel")}),i.Dialog.warnButton({label:this._trans.__("Upload")})]});return t.accept}async _upload(e,t){let s=this._model.path;s=s?s+"/"+e.name:e.name;const i=e.name;const n="file";const r="base64";const a=async(t,a)=>{await this._uploadCheckDisposed();const o=new FileReader;o.readAsDataURL(t);await new Promise(((t,s)=>{o.onload=t;o.onerror=t=>s(`Failed to upload "${e.name}":`+t)}));await this._uploadCheckDisposed();const l=o.result.split(",")[1];const d={type:n,format:r,name:i,chunk:a,content:l};return await this.manager.services.contents.save(s,d)};if(!t){try{return await a(e)}catch(h){o.ArrayExt.removeFirstWhere(this._uploads,(t=>e.name===t.path));throw h}}let l;let d={path:s,progress:0};this._uploadChanged.emit({name:"start",newValue:d,oldValue:null});for(let c=0;!l;c+=ye){const t=c+ye;const i=t>=e.size;const n=i?-1:t/ye;const r={path:s,progress:c/e.size};this._uploads.splice(this._uploads.indexOf(d));this._uploads.push(r);this._uploadChanged.emit({name:"update",newValue:r,oldValue:d});d=r;let m;try{m=await a(e.slice(c,t),n)}catch(h){o.ArrayExt.removeFirstWhere(this._uploads,(t=>e.name===t.path));this._uploadChanged.emit({name:"failure",newValue:d,oldValue:null});throw h}if(i){l=m}}this._uploads.splice(this._uploads.indexOf(d));this._uploadChanged.emit({name:"finish",newValue:null,oldValue:d});return l}_uploadCheckDisposed(){if(this.isDisposed){return Promise.reject("Filemanager disposed. File upload canceled")}return Promise.resolve()}_handleContents(e){this._model={name:e.name,path:e.path,type:e.type,content:undefined,writable:e.writable,created:e.created,last_modified:e.last_modified,mimetype:e.mimetype,format:e.format};this._items=e.content;this._paths.clear();e.content.forEach((e=>{this._paths.add(e.path)}))}_onRunningChanged(e,t){this._populateSessions(t);this._refreshed.emit(void 0)}_onFileChanged(e,t){const s=this._model.path;const{sessions:i}=this.manager.services;const{oldValue:n,newValue:r}=t;const a=n&&n.path&&d.PathExt.dirname(n.path)===s?n:r&&r.path&&d.PathExt.dirname(r.path)===s?r:undefined;if(a){void this._poll.refresh();this._populateSessions(i.running());this._fileChanged.emit(t);return}}_populateSessions(e){this._sessions.length=0;(0,o.each)(e,(e=>{if(this._paths.has(e.path)){this._sessions.push(e)}}))}}class Ee extends we{constructor(e){super(e);this.translator=e.translator||c.nullTranslator;this._filter=e.filter?e.filter:e=>true}items(){return(0,o.filter)(super.items(),((e,t)=>{if(e.type==="directory"){return true}else{return this._filter(e)}}))}setFilter(e){this._filter=e;void this.refresh()}}const be="jp-Open-Dialog";var Ce;(function(e){function t(e){const t=e.translator||c.nullTranslator;const s=t.load("jupyterlab");const n={title:e.title,buttons:[i.Dialog.cancelButton({label:s.__("Cancel")}),i.Dialog.okButton({label:s.__("Select")})],focusNodeSelector:e.focusNodeSelector,host:e.host,renderer:e.renderer,body:new De(e.manager,e.filter,t)};const r=new i.Dialog(n);return r.launch()}e.getOpenFiles=t;function s(e){return t(Object.assign(Object.assign({},e),{filter:e=>false}))}e.getExistingDirectory=s})(Ce||(Ce={}));class De extends a.Widget{constructor(e,t,s){super();s=s||c.nullTranslator;this.addClass(be);this._browser=Ie.createFilteredFileBrowser("filtered-file-browser-dialog",e,t,{},s);const i=new a.PanelLayout;i.addWidget(this._browser);this.layout=i}getValue(){const e=(0,o.toArray)(this._browser.selectedItems());if(e.length===0){return[{path:this._browser.model.path,name:d.PathExt.basename(this._browser.model.path),type:"directory",content:undefined,writable:false,created:"unknown",last_modified:"unknown",mimetype:"text/plain",format:"text"}]}else{return e}}}var Ie;(function(e){e.createFilteredFileBrowser=(e,t,s,i={},n)=>{n=n||c.nullTranslator;const r=new Ee({manager:t,filter:s,translator:n,driveName:i.driveName,refreshInterval:i.refreshInterval});const a=new pe({id:e,model:r,translator:n});return a}})(Ie||(Ie={}));var xe=s(56204);const Le=4;function ke(e){const t=e.translator||c.nullTranslator;const s=t.load("jupyterlab");return re().createElement(xe.GroupItem,{spacing:Le},re().createElement(xe.TextItem,{source:s.__("Uploading…")}),re().createElement(xe.ProgressBar,{percentage:e.upload}))}const Fe=2e3;class Me extends i.VDomRenderer{constructor(e){super(new Me.Model(e.tracker.currentWidget&&e.tracker.currentWidget.model));this._onBrowserChange=(e,t)=>{if(t===null){this.model.browserModel=null}else{this.model.browserModel=t.model}};this.translator=e.translator||c.nullTranslator;this._trans=this.translator.load("jupyterlab");this._tracker=e.tracker;this._tracker.currentChanged.connect(this._onBrowserChange)}render(){const e=this.model.items;if(e.length>0){const e=this.model.items[0];if(e.complete){return re().createElement(xe.TextItem,{source:this._trans.__("Complete!")})}else{return re().createElement(ke,{upload:this.model.items[0].progress,translator:this.translator})}}else{return re().createElement(ke,{upload:100,translator:this.translator})}}dispose(){super.dispose();this._tracker.currentChanged.disconnect(this._onBrowserChange)}}(function(e){class t extends i.VDomModel{constructor(e){super();this._uploadChanged=(e,t)=>{if(t.name==="start"){this._items.push({path:t.newValue.path,progress:t.newValue.progress*100,complete:false})}else if(t.name==="update"){const e=o.ArrayExt.findFirstIndex(this._items,(e=>e.path===t.oldValue.path));if(e!==-1){this._items[e].progress=t.newValue.progress*100}}else if(t.name==="finish"){const e=o.ArrayExt.findFirstIndex(this._items,(e=>e.path===t.oldValue.path));if(e!==-1){this._items[e].complete=true;setTimeout((()=>{o.ArrayExt.removeAt(this._items,e);this.stateChanged.emit(void 0)}),Fe)}}else if(t.name==="failure"){o.ArrayExt.removeFirstWhere(this._items,(e=>e.path===t.newValue.path))}this.stateChanged.emit(void 0)};this._items=[];this._browserModel=null;this.browserModel=e}get items(){return this._items}get browserModel(){return this._browserModel}set browserModel(e){const t=this._browserModel;if(t){t.uploadChanged.disconnect(this._uploadChanged)}this._browserModel=e;this._items=[];if(this._browserModel!==null){this._browserModel.uploadChanged.connect(this._uploadChanged)}this.stateChanged.emit(void 0)}}e.Model=t})(Me||(Me={}))}}]);