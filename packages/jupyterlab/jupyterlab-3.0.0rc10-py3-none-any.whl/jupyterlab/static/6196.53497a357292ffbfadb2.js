(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[6196,3883],{13883:(t,e,i)=>{"use strict";i.r(e);i.d(e,{IImageTracker:()=>r,ImageViewer:()=>l,ImageViewerFactory:()=>d});var s=i(52191);const r=new s.Token("@jupyterlab/imageviewer:IImageTracker");var a=i(66995);var n=i(90265);var o=i(18834);var c=i(86992);const h="jp-ImageViewer";class l extends c.Widget{constructor(t){super();this._scale=1;this._matrix=[1,0,0,1];this._colorinversion=0;this._ready=new s.PromiseDelegate;this.context=t;this.node.tabIndex=-1;this.addClass(h);this._img=document.createElement("img");this.node.appendChild(this._img);this._onTitleChanged();t.pathChanged.connect(this._onTitleChanged,this);void t.ready.then((()=>{if(this.isDisposed){return}const e=t.contentsModel;this._mimeType=e.mimetype;this._render();t.model.contentChanged.connect(this.update,this);t.fileChanged.connect(this.update,this);this._ready.resolve(void 0)}))}[n.Printing.symbol](){return()=>n.Printing.printWidget(this)}get ready(){return this._ready.promise}get scale(){return this._scale}set scale(t){if(t===this._scale){return}this._scale=t;this._updateStyle()}get colorinversion(){return this._colorinversion}set colorinversion(t){if(t===this._colorinversion){return}this._colorinversion=t;this._updateStyle()}resetRotationFlip(){this._matrix=[1,0,0,1];this._updateStyle()}rotateCounterclockwise(){this._matrix=_.prod(this._matrix,_.rotateCounterclockwiseMatrix);this._updateStyle()}rotateClockwise(){this._matrix=_.prod(this._matrix,_.rotateClockwiseMatrix);this._updateStyle()}flipHorizontal(){this._matrix=_.prod(this._matrix,_.flipHMatrix);this._updateStyle()}flipVertical(){this._matrix=_.prod(this._matrix,_.flipVMatrix);this._updateStyle()}onUpdateRequest(t){if(this.isDisposed||!this.context.isReady){return}this._render()}onActivateRequest(t){this.node.focus()}_onTitleChanged(){this.title.label=a.PathExt.basename(this.context.localPath)}_render(){const t=this.context;const e=t.contentsModel;if(!e){return}let i=t.model.toString();if(e.format!=="base64"){i=btoa(i)}this._img.src=`data:${this._mimeType};base64,${i}`}_updateStyle(){const[t,e,i,s]=this._matrix;const[r,a]=_.prodVec(this._matrix,[1,1]);const n=`matrix(${t}, ${e}, ${i}, ${s}, 0, 0) translate(${r<0?-100:0}%, ${a<0?-100:0}%) `;this._img.style.transform=`scale(${this._scale}) ${n}`;this._img.style.filter=`invert(${this._colorinversion})`}}class d extends o.ABCWidgetFactory{createNewWidget(t){const e=new l(t);const i=new o.DocumentWidget({content:e,context:t});return i}}var _;(function(t){function e([t,e,i,s],[r,a,n,o]){return[t*r+e*n,t*a+e*o,i*r+s*n,i*a+s*o]}t.prod=e;function i([t,e,i,s],[r,a]){return[t*r+e*a,i*r+s*a]}t.prodVec=i;t.rotateClockwiseMatrix=[0,1,-1,0];t.rotateCounterclockwiseMatrix=[0,-1,1,0];t.flipHMatrix=[-1,0,0,1];t.flipVMatrix=[1,0,0,-1]})(_||(_={}))}}]);