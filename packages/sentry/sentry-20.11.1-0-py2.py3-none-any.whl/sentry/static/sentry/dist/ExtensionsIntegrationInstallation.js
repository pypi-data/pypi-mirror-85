(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[84],{2008:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n(9),i=n.n(r),o=n(10),a=n.n(o),c=n(12),s=n.n(c),l=n(13),u=n.n(l),p=n(5),f=n.n(p),d=n(249),g=n.n(d),h=(n(1),n(703)),v=n(0);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=f()(t);if(e){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var b=function(t){s()(n,t);var e=y(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getTitle",value:function(){return""}},{key:"render",value:function(){var t=this.getTitle();return Object(v.f)(g.a,{title:"".concat(t?"".concat(t," - "):"","Sentry")},this.renderComponent())}}]),n}(h.a);b.displayName="AsyncView"},2206:function(t,e,n){"use strict";n.d(e,"a",(function(){return z}));var r=n(6),i=n.n(r),o=n(9),a=n.n(o),c=n(10),s=n.n(c),l=n(12),u=n.n(l),p=n(13),f=n.n(p),d=n(5),g=n.n(d),h=n(1),v=n.n(h),y=n(81),b=n(34),O=n(4),m=n(434);function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var z=function(t){u()(n,t);var e=k(n);function n(){var t;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).dialog=null,t.openDialog=function(e){var n=t.props.integrationId;Object(m.m)(w({eventKey:n?"integrations.reauth_start":"integrations.installation_start",eventName:n?"Integrations: Reauth Start":"Integrations: Installation Start",integration:t.props.provider.key,integration_type:"first_party"},t.props.analyticsParams),t.props.organization);var r=t.props.provider.setupDialog,i=r.url,o=r.width,a=r.height,c=t.computeCenteredWindow(o,a),s=c.left,l=c.top,u=w({},e);n&&(u.integration_id=n),t.props.account&&(u.account=t.props.account);var p="".concat(i,"?").concat(y.stringify(u)),f="scrollbars=yes,width=".concat(o,",height=").concat(a,",top=").concat(l,",left=").concat(s);t.dialog=window.open(p,"sentryAddIntegration",f),t.dialog&&t.dialog.focus()},t.didReceiveMessage=function(e){var n=t.props.integrationId;if(e.origin===document.location.origin&&e.source===t.dialog){var r=e.data,i=r.success,o=r.data;t.dialog=null,i?o&&(t.props.onInstall(o),Object(m.m)(w({eventKey:n?"integrations.reauth_complete":"integrations.installation_complete",eventName:n?"Integrations: Reauth Complete":"Integrations: Installation Complete",integration:t.props.provider.key,integration_type:"first_party"},t.props.analyticsParams),t.props.organization),Object(b.d)(Object(O.b)("%s added",t.props.provider.name))):Object(b.a)(o.error)}},t}return s()(n,[{key:"componentDidMount",value:function(){window.addEventListener("message",this.didReceiveMessage)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("message",this.didReceiveMessage),this.dialog&&this.dialog.close()}},{key:"computeCenteredWindow",value:function(t,e){var n=void 0!==window.screenLeft?window.screenLeft:window.screenX,r=void 0!==window.screenTop?window.screenTop:window.screenY;return{left:(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-t/2+n,top:(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-e/2+r}}},{key:"render",value:function(){return this.props.children(this.openDialog)}}]),n}(v.a.Component);z.displayName="AddIntegration"},2910:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return M}));var r=n(33),i=n.n(r),o=n(7),a=n.n(o),c=n(6),s=n.n(c),l=n(9),u=n.n(l),p=n(10),f=n.n(p),d=n(156),g=n.n(d),h=n(12),v=n.n(h),y=n(13),b=n.n(y),O=n(5),m=n.n(O),j=n(3),w=n(1),k=n.n(w),z=n(34),I=n(4),P=n(434),S=n(2206),D=n(73),R=n(2008),_=n(31),A=n(708),E=n(15),C=n(378),W=n(183),L=n(0);function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function F(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var M=function(t){v()(n,t);var e=F(n);function n(){var t;u()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).onInstall=function(e){var n=t.state.organization,r=n&&n.slug;t.props.router.push("/settings/".concat(r,"/integrations/").concat(e.provider.key,"/").concat(e.id))},t.onSelectOrg=function(e){var n=e.value;t.setState({selectedOrg:n,reloading:!0});t.api.request("/organizations/".concat(n,"/"),{success:function(e){return t.setState({organization:e,reloading:!1},t.trackOpened)},error:function(){t.setState({reloading:!1}),Object(z.a)(Object(I.b)("Failed to retrieve organization details"))}}),t.api.request("/organizations/".concat(n,"/config/integrations/"),{success:function(e){return t.setState({providers:e.providers,reloading:!1})},error:function(){t.setState({reloading:!1}),Object(z.a)(Object(I.b)("Failed to retrieve integration provider details"))}})},t.hasAccess=function(t){return t.access.includes("org:integrations")},t}return f()(n,[{key:"getDefaultState",value:function(){return T(T({},g()(m()(n.prototype),"getDefaultState",this).call(this)),{},{selectedOrg:null,organization:null,providers:[]})}},{key:"getEndpoints",value:function(){return[["organizations","/organizations/"]]}},{key:"getTitle",value:function(){return Object(I.b)("Choose Installation Organization")}},{key:"trackOpened",value:function(){var t=this.state.organization,e=this.provider;t&&e&&Object(P.m)({eventKey:"integrations.install_modal_opened",eventName:"Integrations: Install Modal Opened",integration_type:"first_party",integration:e.key,already_installed:!1,view:"external_install"},t,{startSession:!0})}},{key:"renderAddButton",value:function(){var t=this,e=this.state,n=e.organization,r=e.reloading,i=this.props.params.installationId,o=function(t){return Object(L.f)(_.a,a()({priority:"primary",busy:r},t),"Install Integration")};return this.provider?Object(L.f)(S.a,{provider:this.provider,onInstall:this.onInstall},(function(e){return Object(L.f)(o,{disabled:!!n&&!t.hasAccess(n),onClick:function(){return e({installation_id:i})}})})):Object(L.f)(o,{disabled:!0})}},{key:"renderBody",value:function(){var t=this,e=this.state,n=e.organization,r=e.selectedOrg,o=this.state.organizations.map((function(t){return[t.slug,t.slug]})),a=Object(P.d)().FeatureList;return Object(L.f)(C.a,null,Object(L.f)("h3",null,Object(I.b)("Finish integration installation")),Object(L.f)("p",null,Object(I.c)("Please pick a specific [organization:organization] to link with\n            your integration installation.",{organization:Object(L.f)("strong",null)})),r&&n&&!this.hasAccess(n)&&Object(L.f)(D.b,{type:"error",icon:Object(L.f)(E.B,{size:"md"})},Object(L.f)("p",null,Object(I.c)("You do not have permission to install integrations in\n                  [organization]. Ask an organization owner or manager to\n                  visit this page to finish installing this integration.",{organization:Object(L.f)("strong",null,n.slug)})),Object(L.f)(x,null,window.location.href)),this.provider&&n&&this.hasAccess(n)&&a&&Object(L.f)(k.a.Fragment,null,Object(L.f)("p",null,Object(I.c)("The following features will be available for [organization] when installed.",{organization:Object(L.f)("strong",null,n.slug)})),Object(L.f)(a,{organization:n,features:this.provider.metadata.features,provider:this.provider})),Object(L.f)(A.a,{label:Object(I.b)("Organization"),inline:!1,stacked:!0,required:!0},(function(){return Object(L.f)(W.a,{deprecatedSelectControl:!0,onChange:t.onSelectOrg,value:r,placeholder:Object(I.b)("Select an organization"),options:o.map((function(t){var e=i()(t,2);return{value:e[0],label:e[1]}}))})})),Object(L.f)("div",{className:"form-actions"},this.renderAddButton()))}},{key:"provider",get:function(){var t=this;return this.state.providers.find((function(e){return e.key===t.props.params.providerId}))}}]),n}(R.a),x=Object(j.a)("pre",{target:"emticm40",label:"InstallLink"})({name:"1y327hp",styles:"margin-bottom:0;background:#fbe3e1;"})}}]);
//# sourceMappingURL=ExtensionsIntegrationInstallation.js.map