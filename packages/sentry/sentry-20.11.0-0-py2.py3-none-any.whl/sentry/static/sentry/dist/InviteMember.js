(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[103],{1968:function(e,t,n){"use strict";var a=n(15),r=n.n(a),o=n(10),i=n.n(o),s=n(11),c=n.n(s),l=n(12),u=n.n(l),f=n(13),d=n.n(f),m=n(7),b=n.n(m),p=n(4),h=n(1),g=n.n(h),v=n(8),y=n(239),O=n(0);function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=b()(e);if(t){var r=b()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return d()(this,n)}}var T=function(e){u()(n,e);var t=j(n);function n(){return i()(this,n),t.apply(this,arguments)}return c()(n,[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.title,a=e.action,o=e.tabs,i=e.noTitleStyles,s=r()(e,["icon","title","action","tabs","noTitleStyles"]);return Object(O.f)("div",s,Object(O.f)(R,null,t&&Object(O.f)(w,null,t),n&&Object(O.f)(x,{tabs:o,styled:i},Object(O.f)(y.a,null,n)),a&&Object(O.f)(S,{tabs:o},a)),o&&Object(O.f)("div",null,o))}}]),n}(g.a.Component);T.displayName="SettingsPageHeading",T.defaultProps={noTitleStyles:!1};var R=Object(p.a)("div",{target:"e1uay4fd0",label:"TitleAndActions"})({name:"70qvj9",styles:"display:flex;align-items:center;"}),x=Object(p.a)("div",{target:"e1uay4fd1",label:"Title"})((function(e){return!e.styled&&"\n    font-size: 20px;\n    font-weight: bold;"}),";margin:",(function(e){return e.tabs?"".concat(Object(v.a)(4)," ").concat(Object(v.a)(2)," ").concat(Object(v.a)(2)," 0"):"".concat(Object(v.a)(4)," ").concat(Object(v.a)(2)," ").concat(Object(v.a)(4)," 0")}),";flex:1;"),w=Object(p.a)("div",{target:"e1uay4fd2",label:"Icon"})("margin-right:",Object(v.a)(1),";"),S=Object(p.a)("div",{target:"e1uay4fd3",label:"Action"})((function(e){return e.tabs?"margin-top: ".concat(Object(v.a)(2)):null}),";"),k=Object(p.a)(T,{target:"e1uay4fd4",label:"StyledSettingsPageHeading"})("font-size:14px;margin-top:-",Object(v.a)(4),";");t.a=k},2055:function(e,t,n){"use strict";var a=n(4),r=n(0),o=n(113),i=function(e){return Object(r.e)("display:block;width:1rem;height:1rem;border-radius:50%;background-color:",e.theme.green300,";animation:0.2s ",o.d," ease;opacity:",e.disabled?.4:null,";")},s=Object(a.a)("input",{target:"e1d7o7s40",label:"Radio"})("display:flex;padding:0;width:1.5em;height:1.5em;position:relative;border-radius:50%;align-items:center;justify-content:center;border:1px solid ",(function(e){return e.theme.border}),";box-shadow:inset 0 1px 1px rgba(0,0,0,0.04);background:none;appearance:none;margin:0 !important;&:focus,&.focus-visible{outline:none !important;border:1px solid ",(function(e){return e.theme.border}),";box-shadow:rgba(209,202,216,0.5) 0 0 0 3px;}&:checked:after{content:'';",i,"}");s.defaultProps={type:"radio"},t.a=s},2188:function(e,t,n){"use strict";var a=n(22),r=n.n(a),o=n(29),i=n.n(o),s=n(10),c=n.n(s),l=n(11),u=n.n(l),f=n(12),d=n.n(f),m=n(13),b=n.n(m),p=n(7),h=n.n(p),g=n(4),v=n(1),y=n.n(v),O=n(158),j=n.n(O),T=n(30),R=n(185),x=n(16),w=n(3),S=n(31),k=n(197),A=n(309),z=n(418),E=n(680),M=n(68),P=n(8),D=n(54),N=n(0);function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return b()(this,n)}}var I=function(e){d()(n,e);var t=C(n);function n(){var e;c()(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={loading:!0,teams:null},e.fetchTeams=j()(function(){var t=i()(r.a.mark((function t(n){var a,o,i,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props,o=a.api,i=a.organization,t.next=3,o.requestPromise("/organizations/".concat(i.slug,"/teams/"),{query:{query:n,per_page:T.G}});case 3:s=t.sent,e.setState({teams:s,loading:!1});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),T.h),e.handleQueryUpdate=function(t){e.setState({loading:!0}),e.fetchTeams(t.target.value)},e.handleAddTeam=function(t){var n=e.state.teams.find((function(e){return e.slug===t.value}));e.props.onAddTeam(n)},e.handleRemove=function(t){e.props.onRemoveTeam(t)},e}return u()(n,[{key:"componentDidMount",value:function(){this.fetchTeams()}},{key:"renderTeamAddDropDown",value:function(){var e,t=this.props,n=t.disabled,a=t.selectedTeams,r=t.menuHeader,o=this.state.teams,i=null===o||0===o.length,s=n;return e=i?[]:o.filter((function(e){return!a.includes(e.slug)})).map((function(e){return{value:e.slug,searchKey:e.slug,label:Object(N.f)(q,null,"#",e.slug)}})),Object(N.f)(A.a,{items:e,busyItemsStillVisible:this.state.loading,onChange:this.handleQueryUpdate,onSelect:this.handleAddTeam,emptyMessage:Object(w.b)("No teams"),menuHeader:r,disabled:s,alignMenu:"right"},(function(e){var t=e.isOpen;return Object(N.f)(z.a,{"aria-label":Object(w.b)("Add Team"),isOpen:t,size:"xsmall",disabled:s},Object(w.b)("Add Team"))}))}},{key:"renderBody",value:function(){var e=this,t=this.props,n=t.organization,a=t.selectedTeams,r=t.disabled,o=t.confirmLastTeamRemoveMessage;if(0===a.length)return Object(N.f)(E.a,null,Object(w.b)("No Teams assigned"));var i=1===a.length&&o?o:null;return a.map((function(t){return Object(N.f)(L,{key:t,orgId:n.slug,team:t,onRemove:e.handleRemove,disabled:r,confirmMessage:i})}))}},{key:"render",value:function(){return Object(N.f)(R.a,null,Object(N.f)(R.e,{hasButtons:!0},Object(w.b)("Team"),this.renderTeamAddDropDown()),Object(N.f)(R.c,null,this.renderBody()))}}]),n}(y.a.Component);I.displayName="TeamSelect";var L=function(e){var t=e.orgId,n=e.team,a=e.onRemove,r=e.disabled,o=e.confirmMessage;return Object(N.f)(U,null,Object(N.f)(H,{to:"/settings/".concat(t,"/teams/").concat(n,"/")},"#".concat(n)),Object(N.f)(k.a,{message:o,bypass:!o,onConfirm:function(){return a(n)},disabled:r},Object(N.f)(S.a,{size:"xsmall",icon:Object(N.f)(x.xb,{isCircled:!0,size:"xs"}),disabled:r},Object(w.b)("Remove"))))};L.displayName="TeamRow";var q=Object(g.a)("div",{target:"e2fk6ws0",label:"TeamDropdownElement"})("padding:",Object(P.a)(.5)," 0px;text-transform:none;"),U=Object(g.a)(R.f,{target:"e2fk6ws1",label:"TeamPanelItem"})("padding:",Object(P.a)(2),";align-items:center;"),H=Object(g.a)(M.a,{target:"e2fk6ws2",label:"StyledLink"})("flex:1;margin-right:",Object(P.a)(1),";");t.a=Object(D.a)(I)},2284:function(e,t,n){"use strict";var a=n(10),r=n.n(a),o=n(11),i=n.n(o),s=n(12),c=n.n(s),l=n(13),u=n.n(l),f=n(7),d=n.n(f),m=n(4),b=n(1),p=n.n(b),h=n(185),g=n(3),v=n(2055),y=n(683),O=n(0);function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=d()(e);if(t){var r=d()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var T=Object(m.a)("label",{target:"e1noblkb0",label:"Label"})({name:"muoiou",styles:"display:flex;flex:1;align-items:center;margin-bottom:0;"}),R=function(e){c()(n,e);var t=j(n);function n(){return r()(this,n),t.apply(this,arguments)}return i()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.disabled,a=t.enforceAllowed,r=t.roleList,o=t.selectedRole;return Object(O.f)(h.a,null,Object(O.f)(h.e,null,Object(g.b)("Role")),Object(O.f)(h.c,null,r.map((function(t){var r=t.desc,i=t.name,s=t.id,c=t.allowed,l=n||a&&!c;return Object(O.f)(h.f,{key:s,onClick:function(){return!l&&e.props.setRole(s)},css:l?{color:"grey",cursor:"default"}:{}},Object(O.f)(T,null,Object(O.f)(v.a,{id:s,value:i,checked:s===o,readOnly:!0}),Object(O.f)("div",{style:{flex:1,padding:"0 16px"}},i,Object(O.f)(y.a,{noMargin:!0},Object(O.f)("div",{className:"help-block"},r)))))}))))}}]),n}(p.a.Component);R.displayName="RoleSelect",t.a=R},2888:function(e,t,n){"use strict";n.r(t),n.d(t,"InviteMember",(function(){return C}));var a=n(10),r=n.n(a),o=n(11),i=n.n(o),s=n(12),c=n.n(s),l=n(13),u=n.n(l),f=n(7),d=n.n(f),m=n(9),b=n(1),p=n.n(b),h=n(45),g=n.n(h),v=n(47),y=n(32),O=n(30),j=n(3),T=n(54),R=n(59),x=n(31),w=n(35),S=n(49),k=n(1968),A=n(683),z=n(429),E=n(2188),M=n(536),P=n(2284),D=n(0);function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=d()(e);if(t){var r=d()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return u()(this,n)}}var C=function(e){c()(n,e);var t=N(n);function n(e){var a;r()(this,n),(a=t.call(this,e)).redirectToMemberPage=function(){var e=a.props,t=e.params,n=e.router,r=/^\/settings\//.test(n.location.pathname)?"/settings/:orgId/members/":"/organizations/:orgId/members/";n.push(Object(M.a)(r,t))},a.splitEmails=function(e){return e.split(",").map((function(e){return e.trim()})).filter((function(e){return e}))},a.inviteUser=function(e){var t=a.props.organization.slug,n=a.state,r=n.selectedTeams,o=n.selectedRole;return new Promise((function(n,i){a.props.api.request("/organizations/".concat(t,"/members/"),{method:"POST",data:{email:e,teams:Array.from(r.keys()),role:o,referrer:a.props.location.query.referrer},success:function(){Object(y.d)(Object(j.c)("Added [email] to [organization]",{email:e,organization:t})),n()},error:function(t){403===t.status?(Object(y.a)(Object(j.b)("You aren't allowed to invite members.")),n()):409===t.status?(Object(y.a)("User already exists: ".concat(e)),n()):i(t.responseJSON)}})}))},a.submit=function(){var e=a.state.email,t=a.splitEmails(e);t.length&&(a.setState({busy:!0}),Promise.all(t.map(a.inviteUser)).then((function(){return a.redirectToMemberPage()})).catch((function(e){!e||e.email||e.role||v.m((function(t){t.setExtra("error",e),t.setExtra("state",a.state),v.c(new Error("Unknown invite member api response"))})),a.setState({error:e,busy:!1})})))},a.handleAddTeam=function(e){var t=a.state.selectedTeams;t.has(e.slug)||t.add(e.slug),a.setState({selectedTeams:t})},a.handleRemoveTeam=function(e){var t=a.state.selectedTeams;t.delete(e),a.setState({selectedTeams:t})};var o=e.organization.teams,i=1===o.length?[o[0].slug]:[];return a.state={selectedTeams:new Set(i),roleList:[],selectedRole:"member",email:"",loading:!0,busy:!1,error:void 0},a}return i()(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.organization.slug,n=w.default.get("user").isSuperuser;this.props.api.request("/organizations/".concat(t,"/members/me/"),{method:"GET",success:function(t){var n=(t||{}).roles;t&&n?(e.setState({roleList:n,loading:!1}),0===n.filter((function(e){return e.allowed})).length&&e.redirectToMemberPage()):(e.setState({loading:!1,error:{role:'Error loading roles, will default to "member"'}}),v.m((function(n){n.setExtra("resp",t),n.setExtra("state",e.state),v.c(new Error("[members]: data fetch invalid response"))})))},error:function(t){404===t.status&&n?e.setState({roleList:O.y,loading:!1}):0!==t.status&&v.m((function(n){n.setExtra("error",t),n.setExtra("state",e.state),v.c(new Error("[members]: data fetch error"))})),Object(y.a)(Object(j.b)("Error with request, please reload"))}})}},{key:"render",value:function(){var e=this,t=this.state,n=t.error,a=t.loading,r=t.roleList,o=t.selectedRole,i=t.selectedTeams,s=this.props.organization,c=w.default.getConfig().invitesEnabled,l=w.default.get("user").isSuperuser;return Object(D.f)("div",null,Object(D.f)(k.a,{title:Object(j.b)("Add Member to Organization")}),Object(D.f)(A.a,null,c?Object(j.b)("Invite a member to join this organization via their email address. If they do not already have an account, they will first be asked to create one. Multiple emails delimited by commas."):Object(j.b)("You may add a user by their username if they already have an account. Multiple inputs delimited by commas.")),a&&Object(D.f)(S.default,null),!a&&Object(D.f)("div",null,Object(D.f)("div",{className:g()({"has-error":n&&n.email})},Object(D.f)(z.a,{name:"email",label:c?Object(j.b)("Email")+"(s)":Object(j.b)("Username")+"(s)",placeholder:"e.g. teammate@example.com",spellCheck:"false",onChange:function(t){return e.setState({email:t})}}),n&&n.email&&Object(D.f)("p",{className:"error"},n.email)),n&&n.role&&Object(D.f)("p",{className:"error alert-error"},n.role),Object(D.f)(P.a,{enforceAllowed:!l,roleList:r,selectedRole:o,setRole:function(t){return e.setState({selectedRole:t})}}),Object(D.f)(E.a,{organization:s,selectedTeams:Array.from(i.values()),onAddTeam:this.handleAddTeam,onRemoveTeam:this.handleRemoveTeam}),Object(D.f)(x.a,{priority:"primary",busy:this.state.busy,className:"invite-member-submit",onClick:this.submit},Object(j.b)("Add Member"))))}}]),n}(p.a.Component);C.displayName="InviteMember",t.default=Object(T.a)(Object(m.withRouter)(Object(R.a)(C)))}}]);
//# sourceMappingURL=InviteMember.js.map